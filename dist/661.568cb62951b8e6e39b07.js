/*! For license information please see 661.568cb62951b8e6e39b07.js.LICENSE.txt */
"use strict";(self.webpackChunkpersonal_website=self.webpackChunkpersonal_website||[]).push([[661],{444:function(t,e,n){n.d(e,{$s:function(){return T},BH:function(){return o},L:function(){return r},LL:function(){return v},Mn:function(){return d},ZR:function(){return y},b$:function(){return l},d:function(){return u},eu:function(){return g},hl:function(){return p},m9:function(){return I},ru:function(){return h},uI:function(){return c},vZ:function(){return b},w1:function(){return f},zI:function(){return m}});const i=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,h=s>>2,l=(3&s)<<4|o>>4;let u=(15&o)<<2|c>>6,f=63&c;a||(f=64,r||(u=64)),i.push(n[h],n[l],n[u],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],r=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==r||null==o||null==a)throw Error();const c=s<<2|r>>4;if(i.push(c),64!==o){const t=r<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},r=function(t){return function(t){const e=i(t);return s.encodeByteArray(e,!0)}(t).replace(/\./g,"")};class o{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function a(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function c(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(a())}function h(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function l(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function u(){return a().indexOf("Electron/")>=0}function f(){const t=a();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function d(){return a().indexOf("MSAppHost/")>=0}function p(){return"object"==typeof indexedDB}function g(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function m(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class y extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,y.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,v.prototype.create)}}class v{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(w,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new y(i,o,n)}}const w=/\{\$([^}]+)}/g;function b(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(E(n)&&E(r)){if(!b(n,r))return!1}else if(n!==r)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function E(t){return null!==t&&"object"==typeof t}function T(t,e=1e3,n=2){const i=e*Math.pow(n,t),s=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+s)}function I(t){return t&&t._delegate?t._delegate:t}},296:function(t,e,n){n.d(e,{IH:function(){return at}});var i=n(238),s=n(333),r=n(444),o=n(463),a=n(424);const c="@firebase/installations",h="0.5.9",l="w:0.5.9",u=new r.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function f(t){return t instanceof r.ZR&&t.code.includes("request-failed")}function d({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function p(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function g(t,e){const n=(await e.json()).error;return u.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function m({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function y(t){const e=await t();return e.status>=500&&e.status<600?t():e}function v(t){return new Promise((e=>{setTimeout(e,t)}))}const w=/^[cdef][\w-]{21}$/;function b(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return w.test(e)?e:""}catch(t){return""}}function E(t){return`${t.appName}!${t.appId}`}const T=new Map;function I(t,e){const n=E(t);A(n,e),function(t,e){const n=(!C&&"BroadcastChannel"in self&&(C=new BroadcastChannel("[Firebase] FID Change"),C.onmessage=t=>{A(t.data.key,t.data.fid)}),C);n&&n.postMessage({key:t,fid:e}),0===T.size&&C&&(C.close(),C=null)}(n,e)}function A(t,e){const n=T.get(t);if(n)for(const t of n)t(e)}let C=null;const S="firebase-installations-store";let N=null;function D(){return N||(N=(0,a.X3)("firebase-installations-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(S)}})),N}async function _(t,e){const n=E(t),i=(await D()).transaction(S,"readwrite"),s=i.objectStore(S),r=await s.get(n);return await s.put(e,n),await i.done,r&&r.fid===e.fid||I(t,e.fid),e}async function k(t){const e=E(t),n=(await D()).transaction(S,"readwrite");await n.objectStore(S).delete(e),await n.done}async function L(t,e){const n=E(t),i=(await D()).transaction(S,"readwrite"),s=i.objectStore(S),r=await s.get(n),o=e(r);return void 0===o?await s.delete(n):await s.put(o,n),await i.done,!o||r&&r.fid===o.fid||I(t,o.fid),o}async function R(t){let e;const n=await L(t.appConfig,(n=>{const i=function(t){return P(t||{fid:b(),registrationStatus:0})}(n),s=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(u.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=d(t),s=m(t),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:l},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await y((()=>fetch(i,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:p(t.authToken)}}throw await g("Create Installation",c)}(t,e);return _(t.appConfig,n)}catch(n){throw f(n)&&409===n.customData.serverCode?await k(t.appConfig):await _(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:O(t)}:{installationEntry:e}}(t,i);return e=s.registrationPromise,s.installationEntry}));return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function O(t){let e=await M(t.appConfig);for(;1===e.registrationStatus;)await v(100),e=await M(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await R(t);return n||e}return e}function M(t){return L(t,(t=>{if(!t)throw u.create("installation-not-found");return P(t)}))}function P(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function x({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${d(t)}/${e}/authTokens:generate`}(t,n),s=function(t,{refreshToken:e}){const n=m(t);return n.append("Authorization",function(t){return`FIS_v2 ${t}`}(e)),n}(t,n),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={installation:{sdkVersion:l,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await y((()=>fetch(i,a)));if(c.ok)return p(await c.json());throw await g("Generate Auth Token",c)}async function F(t,e=!1){let n;const i=await L(t.appConfig,(i=>{if(!U(i))throw u.create("not-registered");const s=i.authToken;if(!e&&(2===(r=s).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(r)))return i;var r;if(1===s.requestStatus)return n=async function(t,e){let n=await V(t.appConfig);for(;1===n.authToken.requestStatus;)await v(100),n=await V(t.appConfig);const i=n.authToken;return 0===i.requestStatus?F(t,e):i}(t,e),i;{if(!navigator.onLine)throw u.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await x(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await _(t.appConfig,i),n}catch(n){if(!f(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await _(t.appConfig,n)}else await k(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function V(t){return L(t,(t=>{if(!U(t))throw u.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function U(t){return void 0!==t&&2===t.registrationStatus}function B(t){return u.create("missing-app-config-values",{valueName:t})}const j="installations";(0,i.Xd)(new o.wA(j,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw B("App Configuration");if(!t.name)throw B("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw B(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:(0,i.qX)(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),(0,i.Xd)(new o.wA("installations-internal",(t=>{const e=t.getProvider("app").getImmediate(),n=(0,i.qX)(e,j).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await R(e);return i?i.catch(console.error):F(e).catch(console.error),n.fid}(n),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await R(t);e&&await e}(n),(await F(n,e)).token}(n,t)}}),"PRIVATE")),(0,i.KN)(c,h),(0,i.KN)(c,h,"esm2017");const $="analytics",q="https://www.googletagmanager.com/gtag/js",H=new s.Yd("@firebase/analytics");function K(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const G=new r.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),z=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function X(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function W(t,e=z,n){const{appId:i,apiKey:s,measurementId:r}=t.options;if(!i)throw G.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw G.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Q;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),Y({appId:i,apiKey:s,measurementId:r},o,a,e)}async function Y(t,{throttleEndTimeMillis:e,backoffCount:n},i,s=z){const{appId:o,measurementId:a}=t;try{await function(t,e){return new Promise(((n,i)=>{const s=Math.max(e-Date.now(),0),r=setTimeout(n,s);t.addEventListener((()=>{clearTimeout(r),i(G.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(a)return H.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:o,measurementId:a};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,s={method:"GET",headers:X(i)},r="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(r,s);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw G.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return s.deleteThrottleMetadata(o),e}catch(e){if(!function(t){if(!(t instanceof r.ZR&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(e)){if(s.deleteThrottleMetadata(o),a)return H.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:o,measurementId:a};throw e}const c=503===Number(e.customData.httpStatus)?(0,r.$s)(n,s.intervalMillis,30):(0,r.$s)(n,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return s.setThrottleMetadata(o,h),H.debug(`Calling attemptFetch again in ${c} millis`),Y(t,h,i,s)}}class Q{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}class J{constructor(t){this.app=t}_delete(){return delete Z[this.app.options.appId],Promise.resolve()}}let Z={},tt=[];const et={};let nt,it,st="dataLayer",rt=!1;function ot(t,e,n){!function(){const t=[];if((0,r.ru)()&&t.push("This is a browser extension environment."),(0,r.zI)()||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=G.create("invalid-analytics-context",{errorInfo:e});H.warn(n.message)}}();const i=t.options.appId;if(!i)throw G.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw G.create("no-api-key");H.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Z[i])throw G.create("already-exists",{id:i});if(!rt){!function(t){let e=[];Array.isArray(window.dataLayer)?e=window.dataLayer:window.dataLayer=e}();const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,s){let r=function(...t){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(r=window.gtag),window.gtag=function(t,e,n,i){return async function(s,r,o){try{"event"===s?await async function(t,e,n,i,s){try{let r=[];if(s&&s.send_to){let t=s.send_to;Array.isArray(t)||(t=[t]);const i=await K(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),s=t&&e[t.appId];if(!s){r=[];break}r.push(s)}}0===r.length&&(r=Object.values(e)),await Promise.all(r),t("event",i,s||{})}catch(t){H.error(t)}}(t,e,n,r,o):"config"===s?await async function(t,e,n,i,s,r){const o=i[s];try{if(o)await e[o];else{const t=(await K(n)).find((t=>t.measurementId===s));t&&await e[t.appId]}}catch(t){H.error(t)}t("config",s,r)}(t,e,n,i,r,o):t("set",r)}catch(t){H.error(t)}}}(r,t,e,n),{gtagCore:r,wrappedGtag:window.gtag}}(Z,tt,et);it=t,nt=e,rt=!0}return Z[i]=async function(t,e,n,i,s,o,a){var c;const h=W(t);h.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&H.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>H.error(t))),e.push(h);const l=async function(){if(!(0,r.hl)())return H.warn(G.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,r.eu)()}catch(t){return H.warn(G.create("indexeddb-unavailable",{errorInfo:t}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[u,f]=await Promise.all([h,l]);(function(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(q))return e;return null})()||function(t,e){const n=document.createElement("script");n.src=`${q}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}(o,u.measurementId),s("js",new Date);const d=null!==(c=null==a?void 0:a.config)&&void 0!==c?c:{};return d.origin="firebase",d.update=!0,null!=f&&(d.firebase_id=f),s("config",u.measurementId,d),u.measurementId}(t,tt,et,e,nt,st,n),new J(t)}function at(t=(0,i.Mq)()){t=(0,r.m9)(t);const e=(0,i.qX)(t,$);return e.isInitialized()?e.getImmediate():function(t,e={}){const n=(0,i.qX)(t,$);if(n.isInitialized()){const t=n.getImmediate();if((0,r.vZ)(e,n.getOptions()))return t;throw G.create("already-initialized")}return n.initialize({options:e})}(t)}const ct="@firebase/analytics",ht="0.7.9";(0,i.Xd)(new o.wA($,((t,{options:e})=>ot(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),(0,i.Xd)(new o.wA("analytics-internal",(function(t){try{const e=t.getProvider($).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=(0,r.m9)(t),async function(t,e,n,i,s){if(s&&s.global)t("event",n,i);else{const s=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:s}))}}(it,Z[t.app.options.appId],e,n,i).catch((t=>H.error(t)))}(e,t,n,i)}}catch(t){throw G.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),(0,i.KN)(ct,ht),(0,i.KN)(ct,ht,"esm2017")},503:function(t,e,n){n.d(e,{ZF:function(){return i.ZF}});var i=n(238);(0,i.KN)("firebase","9.8.1","app")},591:function(t,e,n){n.d(e,{ET:function(){return mc},hJ:function(){return Ga},ad:function(){return Wa}});var i,s=n(238),r=n(463),o=n(333),a=n(444),c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},h={},l=l||{},u=c||self;function f(){}function d(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var g="closure_uid_"+(1e9*Math.random()>>>0),m=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:v).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function E(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[n].apply(t,s)}}function T(){this.s=this.s,this.o=this.o}var I={};T.prototype.s=!1,T.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,g)&&t[g]||(t[g]=++m)}(this);delete I[t]}},T.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const A=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},C=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const i=t.length,s="string"==typeof t?t.split(""):t;for(let r=0;r<i;r++)r in s&&e.call(n,s[r],r,t)};function S(t){return Array.prototype.concat.apply([],arguments)}function N(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function D(t){return/^[\s\xa0]*$/.test(t)}var _,k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function L(t,e){return-1!=t.indexOf(e)}function R(t,e){return t<e?-1:t>e?1:0}t:{var O=u.navigator;if(O){var M=O.userAgent;if(M){_=M;break t}}_=""}function P(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function x(t){const e={};for(const n in t)e[n]=t[n];return e}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<F.length;e++)n=F[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function U(t){return U[" "](t),t}U[" "]=f;var B,j,$=L(_,"Opera"),q=L(_,"Trident")||L(_,"MSIE"),H=L(_,"Edge"),K=H||q,G=L(_,"Gecko")&&!(L(_.toLowerCase(),"webkit")&&!L(_,"Edge"))&&!(L(_,"Trident")||L(_,"MSIE"))&&!L(_,"Edge"),z=L(_.toLowerCase(),"webkit")&&!L(_,"Edge");function X(){var t=u.document;return t?t.documentMode:void 0}t:{var W="",Y=(j=_,G?/rv:([^\);]+)(\)|;)/.exec(j):H?/Edge\/([\d\.]+)/.exec(j):q?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(j):z?/WebKit\/(\S+)/.exec(j):$?/(?:Version)[ \/]?(\S+)/.exec(j):void 0);if(Y&&(W=Y?Y[1]:""),q){var Q=X();if(null!=Q&&Q>parseFloat(W)){B=String(Q);break t}}B=W}var J,Z={};function tt(){return t=Z,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){let t=0;const e=k(String(B)).split("."),n=k("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var s=e[o]||"",r=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;t=R(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||R(0==s[2].length,0==r[2].length)||R(s[2],r[2]),s=s[3],r=r[3]}while(0==t)}return 0<=t}();var t}u.document&&q?J=X()||parseInt(B,10)||void 0:J=void 0;var et=J,nt=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(t){}return t}();function it(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function st(t,e){if(it.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(G){t:{try{U(e.nodeName);var s=!0;break t}catch(t){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:rt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&st.Z.h.call(this)}}it.prototype.h=function(){this.defaultPrevented=!0},E(st,it);var rt={2:"touch",3:"pen",4:"mouse"};st.prototype.h=function(){st.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ot="closure_listenable_"+(1e6*Math.random()|0),at=0;function ct(t,e,n,i,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ia=s,this.key=++at,this.ca=this.fa=!1}function ht(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function lt(t){this.src=t,this.g={},this.h=0}function ut(t,e){var n=e.type;if(n in t.g){var i,s=t.g[n],r=A(s,e);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(ht(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function ft(t,e,n,i){for(var s=0;s<t.length;++s){var r=t[s];if(!r.ca&&r.listener==e&&r.capture==!!n&&r.ia==i)return s}return-1}lt.prototype.add=function(t,e,n,i,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=ft(t,e,i,s);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new ct(e,this.src,r,!!i,s)).fa=n,t.push(e)),e};var dt="closure_lm_"+(1e6*Math.random()|0),pt={};function gt(t,e,n,i,s){if(i&&i.once)return yt(t,e,n,i,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)gt(t,e[r],n,i,s);return null}return n=At(n),t&&t[ot]?t.N(e,n,p(i)?!!i.capture:!!i,s):mt(t,e,n,!1,i,s)}function mt(t,e,n,i,s,r){if(!e)throw Error("Invalid event type");var o=p(s)?!!s.capture:!!s,a=Tt(t);if(a||(t[dt]=a=new lt(t)),(n=a.add(e,n,i,o,r)).proxy)return n;if(i=function(){var t=Et;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)nt||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),i,s);else if(t.attachEvent)t.attachEvent(bt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function yt(t,e,n,i,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)yt(t,e[r],n,i,s);return null}return n=At(n),t&&t[ot]?t.O(e,n,p(i)?!!i.capture:!!i,s):mt(t,e,n,!0,i,s)}function vt(t,e,n,i,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)vt(t,e[r],n,i,s);else i=p(i)?!!i.capture:!!i,n=At(n),t&&t[ot]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=ft(r=t.g[e],n,i,s))&&(ht(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--))):t&&(t=Tt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ft(e,n,i,s)),(n=-1<t?e[t]:null)&&wt(n))}function wt(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[ot])ut(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(bt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Tt(e))?(ut(n,t),0==n.h&&(n.src=null,e[dt]=null)):ht(t)}}}function bt(t){return t in pt?pt[t]:pt[t]="on"+t}function Et(t,e){if(t.ca)t=!0;else{e=new st(e,this);var n=t.listener,i=t.ia||t.src;t.fa&&wt(t),t=n.call(i,e)}return t}function Tt(t){return(t=t[dt])instanceof lt?t:null}var It="__closure_events_fn_"+(1e9*Math.random()>>>0);function At(t){return"function"==typeof t?t:(t[It]||(t[It]=function(e){return t.handleEvent(e)}),t[It])}function Ct(){T.call(this),this.i=new lt(this),this.P=this,this.I=null}function St(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new it(e,t);else if(e instanceof it)e.target=e.target||t;else{var s=e;V(e=new it(i,t),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];s=Nt(o,i,!0,e)&&s}if(s=Nt(o=e.g=t,i,!0,e)&&s,s=Nt(o,i,!1,e)&&s,n)for(r=0;r<n.length;r++)s=Nt(o=e.g=n[r],i,!1,e)&&s}function Nt(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&ut(t.i,o),s=!1!==a.call(c,i)&&s}}return s&&!i.defaultPrevented}E(Ct,T),Ct.prototype[ot]=!0,Ct.prototype.removeEventListener=function(t,e,n,i){vt(this,t,e,n,i)},Ct.prototype.M=function(){if(Ct.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)ht(n[i]);delete e.g[t],e.h--}}this.I=null},Ct.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Ct.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Dt=u.JSON.stringify;function _t(){var t=xt;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var kt,Lt=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Rt),(t=>t.reset()));class Rt{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Ot(t){u.setTimeout((()=>{throw t}),0)}function Mt(t,e){kt||function(){var t=u.Promise.resolve(void 0);kt=function(){t.then(Ft)}}(),Pt||(kt(),Pt=!0),xt.add(t,e)}var Pt=!1,xt=new class{constructor(){this.h=this.g=null}add(t,e){const n=Lt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Ft(){for(var t;t=_t();){try{t.h.call(t.g)}catch(t){Ot(t)}var e=Lt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Pt=!1}function Vt(t,e){Ct.call(this),this.h=t||1,this.g=e||u,this.j=w(this.kb,this),this.l=Date.now()}function Ut(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Bt(t,e,n){if("function"==typeof t)n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function jt(t){t.g=Bt((()=>{t.g=null,t.i&&(t.i=!1,jt(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}E(Vt,Ct),(i=Vt.prototype).da=!1,i.S=null,i.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),St(this,"tick"),this.da&&(Ut(this),this.start()))}},i.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},i.M=function(){Vt.Z.M.call(this),Ut(this),delete this.g};class $t extends T{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:jt(this)}M(){super.M(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qt(t){T.call(this),this.h=t,this.g={}}E(qt,T);var Ht=[];function Kt(t,e,n,i){Array.isArray(n)||(n&&(Ht[0]=n.toString()),n=Ht);for(var s=0;s<n.length;s++){var r=gt(e,n[s],i||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function Gt(t){P(t.g,(function(t,e){this.g.hasOwnProperty(e)&&wt(t)}),t),t.g={}}function zt(){this.g=!0}function Xt(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return Dt(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}qt.prototype.M=function(){qt.Z.M.call(this),Gt(this)},qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},zt.prototype.Aa=function(){this.g=!1},zt.prototype.info=function(){};var Wt={},Yt=null;function Qt(){return Yt=Yt||new Ct}function Jt(t){it.call(this,Wt.Ma,t)}function Zt(t){const e=Qt();St(e,new Jt(e,t))}function te(t,e){it.call(this,Wt.STAT_EVENT,t),this.stat=e}function ee(t){const e=Qt();St(e,new te(e,t))}function ne(t,e){it.call(this,Wt.Na,t),this.size=e}function ie(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return u.setTimeout((function(){t()}),e)}Wt.Ma="serverreachability",E(Jt,it),Wt.STAT_EVENT="statevent",E(te,it),Wt.Na="timingevent",E(ne,it);var se={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},re={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function oe(){}function ae(t){return t.h||(t.h=t.i())}function ce(){}oe.prototype.h=null;var he,le={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ue(){it.call(this,"d")}function fe(){it.call(this,"c")}function de(){}function pe(t,e,n,i){this.l=t,this.j=e,this.m=n,this.X=i||1,this.V=new qt(this),this.P=me,t=K?125:void 0,this.W=new Vt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ge}function ge(){this.i=null,this.g="",this.h=!1}E(ue,it),E(fe,it),E(de,oe),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},he=new de;var me=45e3,ye={},ve={};function we(t,e,n){t.K=1,t.v=$e(xe(e)),t.s=n,t.U=!0,be(t,null)}function be(t,e){t.F=Date.now(),Ae(t),t.A=xe(t.v);var n=t.A,i=t.X;Array.isArray(i)||(i=[String(i)]),en(n.h,"t",i),t.C=0,n=t.l.H,t.h=new ge,t.g=ni(t.l,n?e:null,!t.s),0<t.O&&(t.L=new $t(w(t.Ia,t,t.g),t.O)),Kt(t.V,t.g,"readystatechange",t.gb),e=t.H?x(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Zt(1),function(t,e,n,i,s,r){t.info((function(){if(t.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var h=a[c].split("=");if(1<h.length){var l=h[0];h=h[1];var u=l.split("_");o=2<=u.length&&"type"==u[1]?o+(l+"=")+h+"&":o+(l+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Ee(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function Te(t,e,n){let i,s=!0;for(;!t.I&&t.C<n.length;){if(i=Ie(t,n),i==ve){4==e&&(t.o=4,ee(14),s=!1),Xt(t.j,t.m,null,"[Incomplete Response]");break}if(i==ye){t.o=4,ee(15),Xt(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}Xt(t.j,t.m,i,null),_e(t,i)}Ee(t)&&i!=ve&&i!=ye&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,ee(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xn(e),e.L=!0,ee(11))):(Xt(t.j,t.m,n,"[Invalid Chunked Response]"),De(t),Ne(t))}function Ie(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?ve:(n=Number(e.substring(n,i)),isNaN(n)?ye:(i+=1)+n>e.length?ve:(e=e.substr(i,n),t.C=i+n,e))}function Ae(t){t.Y=Date.now()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ie(w(t.eb,t),e)}function Se(t){t.B&&(u.clearTimeout(t.B),t.B=null)}function Ne(t){0==t.l.G||t.I||Qn(t.l,t)}function De(t){Se(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ut(t.W),Gt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function _e(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||cn(n.i,t)))if(n.I=t.N,!t.J&&cn(n.i,t)&&3==n.G){try{var i=n.Ca.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Yn(n),Un(n)}zn(n),ee(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&0==n.A&&!n.v&&(n.v=ie(w(n.ab,n),6e3));if(1>=an(n.i)&&n.ka){try{n.ka()}catch(t){}n.ka=void 0}}else Zn(n,11)}else if((t.J||n.g==t)&&Yn(n),!D(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let h=s[e];if(n.U=h[0],h=h[1],2==n.G)if("c"==h[0]){n.J=h[1],n.la=h[2];const e=h[3];null!=e&&(n.ma=e,n.h.info("VER="+n.ma));const s=h[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));const l=h[5];null!=l&&"number"==typeof l&&0<l&&(i=1.5*l,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=i.i;!r.g&&(L(t,"spdy")||L(t,"quic")||L(t,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(hn(r,r.h),r.h=null))}if(i.D){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.sa=t,je(i.F,i.D,t))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=t;if((i=n).oa=ei(i,i.H?i.la:null,i.W),o.J){ln(i.i,o);var a=o,c=i.K;c&&a.setTimeout(c),a.B&&(Se(a),Ae(a)),i.g=o}else Gn(i);0<n.l.length&&$n(n)}else"stop"!=h[0]&&"close"!=h[0]||Zn(n,7);else 3==n.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?Zn(n,7):Vn(n):"noop"!=h[0]&&n.j&&n.j.wa(h),n.A=0)}Zt(4)}catch(t){}}function ke(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)C(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(d(t)||"string"==typeof t){n=[];for(var i=t.length,s=0;s<i;s++)n.push(s)}else for(s in n=[],i=0,t)n[i++]=s;i=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),s=i.length;for(var r=0;r<s;r++)e.call(void 0,i[r],n&&n[r],t)}}function Le(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Le)for(n=t.T(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Re(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var i=t.g[e];Oe(t.h,i)&&(t.g[n++]=i),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)Oe(s,i=t.g[e])||(t.g[n++]=i,s[i]=1),e++;t.g.length=n}}function Oe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(i=pe.prototype).setTimeout=function(t){this.P=t},i.gb=function(t){t=t.target;const e=this.L;e&&3==On(t)?e.l():this.Ia(t)},i.Ia=function(t){try{if(t==this.g)t:{const l=On(this.g);var e=this.g.Da();const f=this.g.ba();if(!(3>l)&&(3!=l||K||this.g&&(this.h.h||this.g.ga()||Mn(this.g)))){this.I||4!=l||7==e||Zt(8==e||0>=f?3:2),Se(this);var n=this.g.ba();this.N=n;e:if(Ee(this)){var i=Mn(this.g);t="";var s=i.length,r=4==On(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){De(this),Ne(this);var o="";break e}this.h.i=new u.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:r&&e==s-1});i.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(t,e,n,i,s,r,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.X,l,n),this.i){if(this.$&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(a)){var h=a;break e}}h=null}if(!(n=h)){this.i=!1,this.o=3,ee(12),De(this),Ne(this);break t}Xt(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,_e(this,n)}this.U?(Te(this,l,o),K&&this.i&&3==l&&(Kt(this.V,this.W,"tick",this.fb),this.W.start())):(Xt(this.j,this.m,o,null),_e(this,o)),4==l&&De(this),this.i&&!this.I&&(4==l?Qn(this.l,this):(this.i=!1,Ae(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,ee(12)):(this.o=0,ee(13)),De(this),Ne(this)}}}catch(t){}},i.fb=function(){if(this.g){var t=On(this.g),e=this.g.ga();this.C<e.length&&(Se(this),Te(this,t,e),this.i&&4!=t&&Ae(this))}},i.cancel=function(){this.I=!0,De(this)},i.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Zt(3),ee(17)),De(this),this.o=2,Ne(this)):Ce(this,this.Y-t)},(i=Le.prototype).R=function(){Re(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},i.T=function(){return Re(this),this.g.concat()},i.get=function(t,e){return Oe(this.h,t)?this.h[t]:e},i.set=function(t,e){Oe(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},i.forEach=function(t,e){for(var n=this.T(),i=0;i<n.length;i++){var s=n[i],r=this.get(s);t.call(e,r,s,this)}};var Me=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Pe(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Pe){this.g=void 0!==e?e:t.g,Fe(this,t.j),this.s=t.s,Ve(this,t.i),Ue(this,t.m),this.l=t.l,e=t.h;var n=new Qe;n.i=e.i,e.g&&(n.g=new Le(e.g),n.h=e.h),Be(this,n),this.o=t.o}else t&&(n=String(t).match(Me))?(this.g=!!e,Fe(this,n[1]||"",!0),this.s=qe(n[2]||""),Ve(this,n[3]||"",!0),Ue(this,n[4]),this.l=qe(n[5]||"",!0),Be(this,n[6]||"",!0),this.o=qe(n[7]||"")):(this.g=!!e,this.h=new Qe(null,this.g))}function xe(t){return new Pe(t)}function Fe(t,e,n){t.j=n?qe(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ve(t,e,n){t.i=n?qe(e,!0):e}function Ue(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Be(t,e,n){e instanceof Qe?(t.h=e,function(t,e){e&&!t.j&&(Je(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ze(this,e),en(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=He(e,We)),t.h=new Qe(e,t.g))}function je(t,e,n){t.h.set(e,n)}function $e(t){return je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function qe(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function He(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ke),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ke(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Pe.prototype.toString=function(){var t=[],e=this.j;e&&t.push(He(e,Ge,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(He(e,Ge,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(He(n,"/"==n.charAt(0)?Xe:ze,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",He(n,Ye)),t.join("")};var Ge=/[#\/\?@]/g,ze=/[#\?:]/g,Xe=/[#\?]/g,We=/[#\?@]/g,Ye=/#/g;function Qe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Je(t){t.g||(t.g=new Le,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var r=t[n].substring(0,i);s=t[n].substring(i+1)}else r=t[n];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ze(t,e){Je(t),e=nn(t,e),Oe(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Oe((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Re(t)))}function tn(t,e){return Je(t),e=nn(t,e),Oe(t.g.h,e)}function en(t,e,n){Ze(t,e),0<n.length&&(t.i=null,t.g.set(nn(t,e),N(n)),t.h+=n.length)}function nn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function sn(t){this.l=t||rn,t=u.PerformanceNavigationTiming?0<(t=u.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(u.g&&u.g.Ea&&u.g.Ea()&&u.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(i=Qe.prototype).add=function(t,e){Je(this),this.i=null,t=nn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},i.forEach=function(t,e){Je(this),this.g.forEach((function(n,i){C(n,(function(n){t.call(e,n,i,this)}),this)}),this)},i.T=function(){Je(this);for(var t=this.g.R(),e=this.g.T(),n=[],i=0;i<e.length;i++)for(var s=t[i],r=0;r<s.length;r++)n.push(e[i]);return n},i.R=function(t){Je(this);var e=[];if("string"==typeof t)tn(this,t)&&(e=S(e,this.g.get(nn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=S(e,t[n])}return e},i.set=function(t,e){return Je(this),this.i=null,tn(this,t=nn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},i.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},i.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var i=e[n],s=encodeURIComponent(String(i));i=this.R(i);for(var r=0;r<i.length;r++){var o=s;""!==i[r]&&(o+="="+encodeURIComponent(String(i[r]))),t.push(o)}}return this.i=t.join("&")};var rn=10;function on(t){return!!t.h||!!t.g&&t.g.size>=t.j}function an(t){return t.h?1:t.g?t.g.size:0}function cn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function hn(t,e){t.g?t.g.add(e):t.h=e}function ln(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function un(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return N(t.i)}function fn(){}function dn(){this.g=new fn}function pn(t,e,n){const i=n||"";try{ke(t,(function(t,n){let s=t;p(t)&&(s=Dt(t)),e.push(i+n+"="+encodeURIComponent(s))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function gn(t,e,n,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch(t){}}function mn(t){this.l=t.$b||null,this.j=t.ib||!1}function yn(t,e){Ct.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=vn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}sn.prototype.cancel=function(){if(this.i=un(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},fn.prototype.stringify=function(t){return u.JSON.stringify(t,void 0)},fn.prototype.parse=function(t){return u.JSON.parse(t,void 0)},E(mn,oe),mn.prototype.g=function(){return new yn(this.l,this.j)},mn.prototype.i=function(t){return function(){return t}}({}),E(yn,Ct);var vn=0;function wn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function bn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,En(t)}function En(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(i=yn.prototype).open=function(t,e){if(this.readyState!=vn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,En(this)},i.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||u).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},i.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,bn(this)),this.readyState=vn},i.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,En(this)),this.g&&(this.readyState=3,En(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==u.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;wn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},i.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?bn(this):En(this),3==this.readyState&&wn(this)}},i.Ua=function(t){this.g&&(this.response=this.responseText=t,bn(this))},i.Ta=function(t){this.g&&(this.response=t,bn(this))},i.ha=function(){this.g&&bn(this)},i.setRequestHeader=function(t,e){this.v.append(t,e)},i.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(yn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Tn=u.JSON.parse;function In(t){Ct.call(this),this.headers=new Le,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=An,this.K=this.L=!1}E(In,Ct);var An="",Cn=/^https?$/i,Sn=["POST","PUT"];function Nn(t){return"content-type"==t.toLowerCase()}function Dn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,_n(t),Ln(t)}function _n(t){t.D||(t.D=!0,St(t,"complete"),St(t,"error"))}function kn(t){if(t.h&&void 0!==l&&(!t.C[1]||4!=On(t)||2!=t.ba()))if(t.v&&4==On(t))Bt(t.Fa,0,t);else if(St(t,"readystatechange"),4==On(t)){t.h=!1;try{const a=t.ba();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===a){var s=String(t.H).match(Me)[1]||null;if(!s&&u.self&&u.self.location){var r=u.self.location.protocol;s=r.substr(0,r.length-1)}i=!Cn.test(s?s.toLowerCase():"")}n=i}if(n)St(t,"complete"),St(t,"success");else{t.m=6;try{var o=2<On(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.ba()+"]",_n(t)}}finally{Ln(t)}}}function Ln(t,e){if(t.g){Rn(t);const n=t.g,i=t.C[0]?f:null;t.g=null,t.C=null,e||St(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Rn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(u.clearTimeout(t.A),t.A=null)}function On(t){return t.g?t.g.readyState:0}function Mn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case An:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Pn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){let e="";return P(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):je(t,e,n))}function xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Fn(t){this.za=0,this.l=[],this.h=new zt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=xn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=xn("baseRetryDelayMs",5e3,t),this.$a=xn("retryDelaySeedMs",1e4,t),this.Ya=xn("forwardChannelMaxRetries",2,t),this.ra=xn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new sn(t&&t.concurrentRequestLimit),this.Ca=new dn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Vn(t){if(Bn(t),3==t.G){var e=t.V++,n=xe(t.F);je(n,"SID",t.J),je(n,"RID",e),je(n,"TYPE","terminate"),Hn(t,n),(e=new pe(t,t.h,e,void 0)).K=2,e.v=$e(xe(n)),n=!1,u.navigator&&u.navigator.sendBeacon&&(n=u.navigator.sendBeacon(e.v.toString(),"")),!n&&u.Image&&((new Image).src=e.v,n=!0),n||(e.g=ni(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Ae(e)}ti(t)}function Un(t){t.g&&(Xn(t),t.g.cancel(),t.g=null)}function Bn(t){Un(t),t.u&&(u.clearTimeout(t.u),t.u=null),Yn(t),t.i.cancel(),t.m&&("number"==typeof t.m&&u.clearTimeout(t.m),t.m=null)}function jn(t,e){t.l.push(new class{constructor(t,e){this.h=t,this.g=e}}(t.Za++,e)),3==t.G&&$n(t)}function $n(t){on(t.i)||t.m||(t.m=!0,Mt(t.Ha,t),t.C=0)}function qn(t,e){var n;n=e?e.m:t.V++;const i=xe(t.F);je(i,"SID",t.J),je(i,"RID",n),je(i,"AID",t.U),Hn(t,i),t.o&&t.s&&Pn(i,t.o,t.s),n=new pe(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),hn(t.i,n),we(n,i,e)}function Hn(t,e){t.j&&ke({},(function(t,n){je(e,n,t)}))}function Kn(t,e,n){n=Math.min(t.l.length,n);var i=t.j?w(t.j.Oa,t.j,t):null;t:{var s=t.l;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let r=!0;for(let o=0;o<n;o++){let n=s[o].h;const a=s[o].g;if(n-=e,0>n)e=Math.max(0,s[o].h-100),r=!1;else try{pn(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(r){i=t.join("&");break t}}}return t=t.l.splice(0,n),e.D=t,i}function Gn(t){t.g||t.u||(t.Y=1,Mt(t.Ga,t),t.A=0)}function zn(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=ie(w(t.Ga,t),Jn(t,t.A)),t.A++,0))}function Xn(t){null!=t.B&&(u.clearTimeout(t.B),t.B=null)}function Wn(t){t.g=new pe(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=xe(t.oa);je(e,"RID","rpc"),je(e,"SID",t.J),je(e,"CI",t.N?"0":"1"),je(e,"AID",t.U),Hn(t,e),je(e,"TYPE","xmlhttp"),t.o&&t.s&&Pn(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=$e(xe(e)),n.s=null,n.U=!0,be(n,t)}function Yn(t){null!=t.v&&(u.clearTimeout(t.v),t.v=null)}function Qn(t,e){var n=null;if(t.g==e){Yn(t),Xn(t),t.g=null;var i=2}else{if(!cn(t.i,e))return;n=e.D,ln(t.i,e),i=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;St(i=Qt(),new ne(i,n,e,s)),$n(t)}else Gn(t);else if(3==(s=e.o)||0==s&&0<t.I||!(1==i&&function(t,e){return!(an(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=ie(w(t.Ha,t,e),Jn(t,t.C)),t.C++,0)))}(t,e)||2==i&&zn(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Zn(t,5);break;case 4:Zn(t,10);break;case 3:Zn(t,6);break;default:Zn(t,2)}}function Jn(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Zn(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var i=w(t.jb,t);n||(n=new Pe("//www.google.com/images/cleardot.gif"),u.location&&"http"==u.location.protocol||Fe(n,"https"),$e(n)),function(t,e){const n=new zt;if(u.Image){const i=new Image;i.onload=b(gn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=b(gn,n,i,"TestLoadImage: error",!1,e),i.onabort=b(gn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=b(gn,n,i,"TestLoadImage: timeout",!1,e),u.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else ee(2);t.G=0,t.j&&t.j.va(e),ti(t),Bn(t)}function ti(t){t.G=0,t.I=-1,t.j&&(0==un(t.i).length&&0==t.l.length||(t.i.i.length=0,N(t.l),t.l.length=0),t.j.ua())}function ei(t,e,n){let i=function(t){return t instanceof Pe?xe(t):new Pe(t,void 0)}(n);if(""!=i.i)e&&Ve(i,e+"."+i.i),Ue(i,i.m);else{const t=u.location;i=function(t,e,n,i){var s=new Pe(null,void 0);return t&&Fe(s,t),e&&Ve(s,e),n&&Ue(s,n),i&&(s.l=i),s}(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,n)}return t.aa&&P(t.aa,(function(t,e){je(i,e,t)})),e=t.D,n=t.sa,e&&n&&je(i,e,n),je(i,"VER",t.ma),Hn(t,i),i}function ni(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new In(new mn({ib:!0})):new In(t.qa)).L=t.H,e}function ii(){}function si(){if(q&&!(10<=Number(et)))throw Error("Environmental error: no available transport.")}function ri(t,e){Ct.call(this),this.g=new Fn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!D(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!D(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ci(this)}function oi(t){ue.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ai(){fe.call(this),this.status=1}function ci(t){this.g=t}(i=In.prototype).ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():he.g(),this.C=this.u?ae(this.u):ae(he),this.g.onreadystatechange=w(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Dn(this,t)}t=n||"";const s=new Le(this.headers);i&&ke(i,(function(t,e){s.set(e,t)})),i=function(t){t:{var e=Nn;const n=t.length,i="string"==typeof t?t.split(""):t;for(let s=0;s<n;s++)if(s in i&&e.call(void 0,i[s],s,t)){e=s;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(s.T()),n=u.FormData&&t instanceof u.FormData,!(0<=A(Sn,e))||i||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Rn(this),0<this.B&&((this.K=function(t){return q&&tt()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=w(this.pa,this)):this.A=Bt(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Dn(this,t)}},i.pa=function(){void 0!==l&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,St(this,"timeout"),this.abort(8))},i.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,St(this,"complete"),St(this,"abort"),Ln(this))},i.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ln(this,!0)),In.Z.M.call(this)},i.Fa=function(){this.s||(this.F||this.v||this.l?kn(this):this.cb())},i.cb=function(){kn(this)},i.ba=function(){try{return 2<On(this)?this.g.status:-1}catch(t){return-1}},i.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},i.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Tn(e)}},i.Da=function(){return this.m},i.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(i=Fn.prototype).ma=8,i.G=1,i.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},i.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new pe(this,this.h,t,void 0);let r=this.s;if(this.P&&(r?(r=x(r),V(r,this.P)):r=this.P),null===this.o&&(s.H=r),this.ja)t:{for(var e=0,n=0;n<this.l.length;n++){var i=this.l[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.l.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Kn(this,s,e),je(n=xe(this.F),"RID",t),je(n,"CVER",22),this.D&&je(n,"X-HTTP-Session-Id",this.D),Hn(this,n),this.o&&r&&Pn(n,this.o,r),hn(this.i,s),this.Ra&&je(n,"TYPE","init"),this.ja?(je(n,"$req",e),je(n,"SID","null"),s.$=!0,we(s,n,null)):we(s,n,e),this.G=2}}else 3==this.G&&(t?qn(this,t):0==this.l.length||on(this.i)||qn(this))},i.Ga=function(){if(this.u=null,Wn(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ie(w(this.bb,this),t)}},i.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ee(10),Un(this),Wn(this))},i.ab=function(){null!=this.v&&(this.v=null,Un(this),zn(this),ee(19))},i.jb=function(t){t?(this.h.info("Successfully pinged google.com"),ee(2)):(this.h.info("Failed to ping google.com"),ee(1))},(i=ii.prototype).xa=function(){},i.wa=function(){},i.va=function(){},i.ua=function(){},i.Oa=function(){},si.prototype.g=function(t,e){return new ri(t,e)},E(ri,Ct),ri.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Mt(w(t.hb,t,e))),ee(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=ei(t,null,t.W),$n(t)},ri.prototype.close=function(){Vn(this.g)},ri.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,jn(this.g,e)}else this.v?((e={}).__data__=Dt(t),jn(this.g,e)):jn(this.g,t)},ri.prototype.M=function(){this.g.j=null,delete this.j,Vn(this.g),delete this.g,ri.Z.M.call(this)},E(oi,ue),E(ai,fe),E(ci,ii),ci.prototype.xa=function(){St(this.g,"a")},ci.prototype.wa=function(t){St(this.g,new oi(t))},ci.prototype.va=function(t){St(this.g,new ai(t))},ci.prototype.ua=function(){St(this.g,"b")},si.prototype.createWebChannel=si.prototype.g,ri.prototype.send=ri.prototype.u,ri.prototype.open=ri.prototype.m,ri.prototype.close=ri.prototype.close,se.NO_ERROR=0,se.TIMEOUT=8,se.HTTP_ERROR=6,re.COMPLETE="complete",ce.EventType=le,le.OPEN="a",le.CLOSE="b",le.ERROR="c",le.MESSAGE="d",Ct.prototype.listen=Ct.prototype.N,In.prototype.listenOnce=In.prototype.O,In.prototype.getLastError=In.prototype.La,In.prototype.getLastErrorCode=In.prototype.Da,In.prototype.getStatus=In.prototype.ba,In.prototype.getResponseJson=In.prototype.Qa,In.prototype.getResponseText=In.prototype.ga,In.prototype.send=In.prototype.ea;var hi=h.createWebChannelTransport=function(){return new si},li=h.getStatEventTarget=function(){return Qt()},ui=h.ErrorCode=se,fi=h.EventType=re,di=h.Event=Wt,pi=h.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},gi=h.FetchXmlHttpFactory=mn,mi=h.WebChannel=ce,yi=h.XhrIo=In;const vi="@firebase/firestore";class wi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}wi.UNAUTHENTICATED=new wi(null),wi.GOOGLE_CREDENTIALS=new wi("google-credentials-uid"),wi.FIRST_PARTY=new wi("first-party-uid"),wi.MOCK_USER=new wi("mock-user");let bi="9.8.0";const Ei=new o.Yd("@firebase/firestore");function Ti(){return Ei.logLevel}function Ii(t,...e){if(Ei.logLevel<=o.in.DEBUG){const n=e.map(Si);Ei.debug(`Firestore (${bi}): ${t}`,...n)}}function Ai(t,...e){if(Ei.logLevel<=o.in.ERROR){const n=e.map(Si);Ei.error(`Firestore (${bi}): ${t}`,...n)}}function Ci(t,...e){if(Ei.logLevel<=o.in.WARN){const n=e.map(Si);Ei.warn(`Firestore (${bi}): ${t}`,...n)}}function Si(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Ni(t="Unexpected state"){const e=`FIRESTORE (${bi}) INTERNAL ASSERTION FAILED: `+t;throw Ai(e),new Error(e)}function Di(t,e){t||Ni()}function _i(t,e){return t}const ki={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Li extends a.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ri{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Oi{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Mi{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(wi.UNAUTHENTICATED)))}shutdown(){}}class Pi{constructor(t){this.t=t,this.currentUser=wi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new Ri;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ri,t.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const e=s;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Ii("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Ii("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ri)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ii("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Di("string"==typeof e.accessToken),new Oi(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Di(null===t||"string"==typeof t),new wi(t)}}class xi{constructor(t,e,n){this.type="FirstParty",this.user=wi.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",e);const i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class Fi{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new xi(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(wi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Vi{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ui{constructor(t){this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(t,e){const n=t=>{null!=t.error&&Ii("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.p;return this.p=t.token,Ii("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Ii("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.g.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.g.getImmediate({optional:!0});t?i(t):Ii("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Di("string"==typeof t.token),this.p=t.token,new Vi(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class Bi{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.I(t),this.T=t=>e.writeSequenceNumber(t))}I(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.T&&this.T(t),t}}function ji(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}Bi.A=-1;class $i{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=ji(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<e&&(n+=t.charAt(i[s]%t.length))}return n}}function qi(t,e){return t<e?-1:t>e?1:0}function Hi(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class Ki{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Li(ki.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Li(ki.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Li(ki.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Li(ki.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Ki.fromMillis(Date.now())}static fromDate(t){return Ki.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Ki(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?qi(this.nanoseconds,t.nanoseconds):qi(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Gi{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Gi(t)}static min(){return new Gi(new Ki(0,0))}static max(){return new Gi(new Ki(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function zi(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Xi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Wi(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Yi{constructor(t,e,n){void 0===e?e=0:e>t.length&&Ni(),void 0===n?n=t.length-e:n>t.length-e&&Ni(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Yi.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Yi?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),s=e.get(i);if(n<s)return-1;if(n>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Qi extends Yi{construct(t,e,n){return new Qi(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Li(ki.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Qi(e)}static emptyPath(){return new Qi([])}}const Ji=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zi extends Yi{construct(t,e,n){return new Zi(t,e,n)}static isValidIdentifier(t){return Ji.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zi.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Zi(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Li(ki.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let r=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Li(ki.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Li(ki.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(r=!r,i++):"."!==e||r?(n+=e,i++):(s(),i++)}if(s(),r)throw new Li(ki.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Zi(e)}static emptyPath(){return new Zi([])}}class ts{constructor(t){this.fields=t,t.sort(Zi.comparator)}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Hi(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class es{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new es(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new es(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return qi(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}es.EMPTY_BYTE_STRING=new es("");const ns=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function is(t){if(Di(!!t),"string"==typeof t){let e=0;const n=ns.exec(t);if(Di(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ss(t.seconds),nanos:ss(t.nanos)}}function ss(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function rs(t){return"string"==typeof t?es.fromBase64String(t):es.fromUint8Array(t)}function os(t){const e=is(t.mapValue.fields.__local_write_time__.timestampValue);return new Ki(e.seconds,e.nanos)}class as{constructor(t,e,n,i,s,r,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class cs{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new cs("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof cs&&t.projectId===this.projectId&&t.database===this.database}}function hs(t){return null==t}function ls(t){return 0===t&&1/t==-1/0}class us{constructor(t){this.path=t}static fromPath(t){return new us(Qi.fromString(t))}static fromName(t){return new us(Qi.fromString(t).popFirst(5))}static empty(){return new us(Qi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Qi.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Qi.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new us(new Qi(t.slice()))}}const fs={fields:{__type__:{stringValue:"__max__"}}};function ds(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?function(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}(t)?4:As(t)?9007199254740991:10:Ni()}function ps(t,e){if(t===e)return!0;const n=ds(t);if(n!==ds(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return os(t).isEqual(os(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=is(t.timestampValue),i=is(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return rs(t.bytesValue).isEqual(rs(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ss(t.geoPointValue.latitude)===ss(e.geoPointValue.latitude)&&ss(t.geoPointValue.longitude)===ss(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ss(t.integerValue)===ss(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=ss(t.doubleValue),i=ss(e.doubleValue);return n===i?ls(n)===ls(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Hi(t.arrayValue.values||[],e.arrayValue.values||[],ps);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(zi(n)!==zi(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!ps(n[t],i[t])))return!1;return!0}(t,e);default:return Ni()}}function gs(t,e){return void 0!==(t.values||[]).find((t=>ps(t,e)))}function ms(t,e){if(t===e)return 0;const n=ds(t),i=ds(e);if(n!==i)return qi(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return qi(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=ss(t.integerValue||t.doubleValue),i=ss(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return ys(t.timestampValue,e.timestampValue);case 4:return ys(os(t),os(e));case 5:return qi(t.stringValue,e.stringValue);case 6:return function(t,e){const n=rs(t),i=rs(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=qi(n[t],i[t]);if(0!==e)return e}return qi(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=qi(ss(t.latitude),ss(e.latitude));return 0!==n?n:qi(ss(t.longitude),ss(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=ms(n[t],i[t]);if(e)return e}return qi(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===fs&&e===fs)return 0;if(t===fs)return 1;if(e===fs)return-1;const n=t.fields||{},i=Object.keys(n),s=e.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let t=0;t<i.length&&t<r.length;++t){const e=qi(i[t],r[t]);if(0!==e)return e;const o=ms(n[i[t]],s[r[t]]);if(0!==o)return o}return qi(i.length,r.length)}(t.mapValue,e.mapValue);default:throw Ni()}}function ys(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return qi(t,e);const n=is(t),i=is(e),s=qi(n.seconds,i.seconds);return 0!==s?s:qi(n.nanos,i.nanos)}function vs(t){return ws(t)}function ws(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=is(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?rs(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,us.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=ws(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const s of e)i?i=!1:n+=",",n+=`${s}:${ws(t.fields[s])}`;return n+"}"}(t.mapValue):Ni();var e,n}function bs(t){return!!t&&"integerValue"in t}function Es(t){return!!t&&"arrayValue"in t}function Ts(t){return!!t&&"mapValue"in t}function Is(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Xi(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Is(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Is(t.arrayValue.values[n]);return e}return Object.assign({},t)}function As(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Cs{constructor(t){this.value=t}static empty(){return new Cs({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Ts(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Is(e)}setAll(t){let e=Zi.emptyPath(),n={},i=[];t.forEach(((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=s.popLast()}t?n[s.lastSegment()]=Is(t):i.push(s.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,n,i)}delete(t){const e=this.field(t.popLast());Ts(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ps(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Ts(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){Xi(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Cs(Is(this.value))}}function Ss(t){const e=[];return Xi(t.fields,((t,n)=>{const i=new Zi([t]);if(Ts(n)){const t=Ss(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new ts(e)}class Ns{constructor(t,e,n,i,s,r){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.data=s,this.documentState=r}static newInvalidDocument(t){return new Ns(t,0,Gi.min(),Gi.min(),Cs.empty(),0)}static newFoundDocument(t,e,n){return new Ns(t,1,e,Gi.min(),n,0)}static newNoDocument(t,e){return new Ns(t,2,e,Gi.min(),Cs.empty(),0)}static newUnknownDocument(t,e){return new Ns(t,3,e,Gi.min(),Cs.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Cs.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Cs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ns&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ns(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function Ds(t){return new _s(t.readTime,t.key,-1)}class _s{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new _s(Gi.min(),us.empty(),-1)}static max(){return new _s(Gi.max(),us.empty(),-1)}}function ks(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=us.comparator(t.documentKey,e.documentKey),0!==n?n:qi(t.largestBatchId,e.largestBatchId))}class Ls{constructor(t,e){this.comparator=t,this.root=e||Os.EMPTY}insert(t,e){return new Ls(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Os.BLACK,null,null))}remove(t){return new Ls(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Os.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Rs(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Rs(this.root,t,this.comparator,!1)}getReverseIterator(){return new Rs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Rs(this.root,t,this.comparator,!0)}}class Rs{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Os{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:Os.RED,this.left=null!=i?i:Os.EMPTY,this.right=null!=s?s:Os.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,s){return new Os(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Os.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return Os.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Os.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Os.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ni();if(this.right.isRed())throw Ni();const t=this.left.check();if(t!==this.right.check())throw Ni();return t+(this.isRed()?0:1)}}Os.EMPTY=null,Os.RED=!0,Os.BLACK=!1,Os.EMPTY=new class{constructor(){this.size=0}get key(){throw Ni()}get value(){throw Ni()}get color(){throw Ni()}get left(){throw Ni()}get right(){throw Ni()}copy(t,e,n,i,s){return this}insert(t,e,n){return new Os(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ms{constructor(t){this.comparator=t,this.data=new Ls(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Ps(this.data.getIterator())}getIteratorFrom(t){return new Ps(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Ms))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Ms(this.comparator);return e.data=t,e}}class Ps{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class xs{constructor(t,e=null,n=[],i=[],s=null,r=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=o,this.P=null}}function Fs(t,e=null,n=[],i=[],s=null,r=null,o=null){return new xs(t,e,n,i,s,r,o)}function Vs(t){const e=_i(t);if(null===e.P){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>{return(e=t).field.canonicalString()+e.op.toString()+vs(e.value);var e})).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),hs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>vs(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>vs(t))).join(",")),e.P=t}return e.P}function Us(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Qs(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],i=e.filters[s],n.op!==i.op||!n.field.isEqual(i.field)||!ps(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Zs(t.startAt,e.startAt)&&Zs(t.endAt,e.endAt)}class Bs extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.V(t,e,n):new js(t,e,n):"array-contains"===e?new Ks(t,n):"in"===e?new Gs(t,n):"not-in"===e?new zs(t,n):"array-contains-any"===e?new Xs(t,n):new Bs(t,e,n)}static V(t,e,n){return"in"===e?new $s(t,n):new qs(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.v(ms(e,this.value)):null!==e&&ds(this.value)===ds(e)&&this.v(ms(e,this.value))}v(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ni()}}S(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class js extends Bs{constructor(t,e,n){super(t,e,n),this.key=us.fromName(n.referenceValue)}matches(t){const e=us.comparator(t.key,this.key);return this.v(e)}}class $s extends Bs{constructor(t,e){super(t,"in",e),this.keys=Hs(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class qs extends Bs{constructor(t,e){super(t,"not-in",e),this.keys=Hs(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Hs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>us.fromName(t.referenceValue)))}class Ks extends Bs{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Es(e)&&gs(e.arrayValue,this.value)}}class Gs extends Bs{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&gs(this.value.arrayValue,e)}}class zs extends Bs{constructor(t,e){super(t,"not-in",e)}matches(t){if(gs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!gs(this.value.arrayValue,e)}}class Xs extends Bs{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Es(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>gs(this.value.arrayValue,t)))}}class Ws{constructor(t,e){this.position=t,this.inclusive=e}}class Ys{constructor(t,e="asc"){this.field=t,this.dir=e}}function Qs(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Js(t,e,n){let i=0;for(let s=0;s<t.position.length;s++){const r=e[s],o=t.position[s];if(i=r.field.isKeyField()?us.comparator(us.fromName(o.referenceValue),n.key):ms(o,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function Zs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ps(t.position[n],e.position[n]))return!1;return!0}class tr{constructor(t,e=null,n=[],i=[],s=null,r="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=o,this.endAt=a,this.D=null,this.C=null,this.startAt,this.endAt}}function er(t){const e=_i(t);if(null===e.D){e.D=[];const t=function(t){for(const e of t.filters)if(e.S())return e.field;return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.D.push(new Ys(t)),e.D.push(new Ys(Zi.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.D.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.D.push(new Ys(Zi.keyField(),t))}}}return e.D}function nr(t){const e=_i(t);if(!e.C)if("F"===e.limitType)e.C=Fs(e.path,e.collectionGroup,er(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of er(e)){const e="desc"===n.dir?"asc":"desc";t.push(new Ys(n.field,e))}const n=e.endAt?new Ws(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Ws(e.startAt.position,e.startAt.inclusive):null;e.C=Fs(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.C}function ir(t,e){return Us(nr(t),nr(e))&&t.limitType===e.limitType}function sr(t){return`${Vs(nr(t))}|lt:${t.limitType}`}function rr(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${vs(e.value)}`;var e})).join(", ")}]`),hs(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>vs(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>vs(t))).join(",")),`Target(${e})`}(nr(t))}; limitType=${t.limitType})`}function or(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):us.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Js(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,er(t),e)||t.endAt&&!function(t,e,n){const i=Js(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,er(t),e))}(t,e)}function ar(t,e,n){const i=t.field.isKeyField()?us.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),s=n.data.field(t);return null!==i&&null!==s?ms(i,s):Ni()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Ni()}}function cr(t,e){if(t.N){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ls(e)?"-0":e}}function hr(t){return{integerValue:""+t}}function lr(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ls(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?hr(e):cr(t,e)}class ur{constructor(){this._=void 0}}function fr(t,e,n){return t instanceof gr?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof mr?yr(t,e):t instanceof vr?wr(t,e):function(t,e){const n=pr(t,e),i=Er(n)+Er(t.k);return bs(n)&&bs(t.k)?hr(i):cr(t.M,i)}(t,e)}function dr(t,e,n){return t instanceof mr?yr(t,e):t instanceof vr?wr(t,e):n}function pr(t,e){return t instanceof br?bs(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class gr extends ur{}class mr extends ur{constructor(t){super(),this.elements=t}}function yr(t,e){const n=Tr(e);for(const e of t.elements)n.some((t=>ps(t,e)))||n.push(e);return{arrayValue:{values:n}}}class vr extends ur{constructor(t){super(),this.elements=t}}function wr(t,e){let n=Tr(e);for(const e of t.elements)n=n.filter((t=>!ps(t,e)));return{arrayValue:{values:n}}}class br extends ur{constructor(t,e){super(),this.M=t,this.k=e}}function Er(t){return ss(t.integerValue||t.doubleValue)}function Tr(t){return Es(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ir{constructor(t,e){this.version=t,this.transformResults=e}}class Ar{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ar}static exists(t){return new Ar(void 0,t)}static updateTime(t){return new Ar(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Cr(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Sr{}function Nr(t,e,n){t instanceof Rr?function(t,e,n){const i=t.value.clone(),s=Pr(t.fieldTransforms,e,n.transformResults);i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Or?function(t,e,n){if(!Cr(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Pr(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(Mr(t)),s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Dr(t,e,n){t instanceof Rr?function(t,e,n){if(!Cr(t.precondition,e))return;const i=t.value.clone(),s=xr(t.fieldTransforms,n,e);i.setAll(s),e.convertToFoundDocument(Lr(e),i).setHasLocalMutations()}(t,e,n):t instanceof Or?function(t,e,n){if(!Cr(t.precondition,e))return;const i=xr(t.fieldTransforms,n,e),s=e.data;s.setAll(Mr(t)),s.setAll(i),e.convertToFoundDocument(Lr(e),s).setHasLocalMutations()}(t,e,n):function(t,e){Cr(t.precondition,e)&&e.convertToNoDocument(Gi.min())}(t,e)}function _r(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),s=pr(i.transform,t||null);null!=s&&(null==n&&(n=Cs.empty()),n.set(i.field,s))}return n||null}function kr(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Hi(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof mr&&e instanceof mr||t instanceof vr&&e instanceof vr?Hi(t.elements,e.elements,ps):t instanceof br&&e instanceof br?ps(t.k,e.k):t instanceof gr&&e instanceof gr}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Lr(t){return t.isFoundDocument()?t.version:Gi.min()}class Rr extends Sr{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}}class Or extends Sr{constructor(t,e,n,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}}function Mr(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Pr(t,e,n){const i=new Map;Di(t.length===n.length);for(let s=0;s<n.length;s++){const r=t[s],o=r.transform,a=e.data.field(r.field);i.set(r.field,dr(o,a,n[s]))}return i}function xr(t,e,n){const i=new Map;for(const s of t){const t=s.transform,r=n.data.field(s.field);i.set(s.field,fr(t,r,e))}return i}class Fr extends Sr{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}}class Vr extends Sr{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}}var Ur,Br;(Br=Ur||(Ur={}))[Br.OK=0]="OK",Br[Br.CANCELLED=1]="CANCELLED",Br[Br.UNKNOWN=2]="UNKNOWN",Br[Br.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Br[Br.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Br[Br.NOT_FOUND=5]="NOT_FOUND",Br[Br.ALREADY_EXISTS=6]="ALREADY_EXISTS",Br[Br.PERMISSION_DENIED=7]="PERMISSION_DENIED",Br[Br.UNAUTHENTICATED=16]="UNAUTHENTICATED",Br[Br.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Br[Br.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Br[Br.ABORTED=10]="ABORTED",Br[Br.OUT_OF_RANGE=11]="OUT_OF_RANGE",Br[Br.UNIMPLEMENTED=12]="UNIMPLEMENTED",Br[Br.INTERNAL=13]="INTERNAL",Br[Br.UNAVAILABLE=14]="UNAVAILABLE",Br[Br.DATA_LOSS=15]="DATA_LOSS";class jr{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Xi(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return Wi(this.inner)}size(){return this.innerSize}}const $r=new Ls(us.comparator);function qr(){return $r}const Hr=new Ls(us.comparator);function Kr(...t){let e=Hr;for(const n of t)e=e.insert(n.key,n);return e}function Gr(){return new jr((t=>t.toString()),((t,e)=>t.isEqual(e)))}const zr=new Ls(us.comparator),Xr=new Ms(us.comparator);function Wr(...t){let e=Xr;for(const n of t)e=e.add(n);return e}const Yr=new Ms(qi);class Qr{constructor(t,e){this.databaseId=t,this.N=e}}function Jr(t,e){return t.N?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zr(t,e){return t.N?e.toBase64():e.toUint8Array()}function to(t,e){return Jr(t,e.toTimestamp())}function eo(t){return Di(!!t),Gi.fromTimestamp(function(t){const e=is(t);return new Ki(e.seconds,e.nanos)}(t))}function no(t,e){return function(t){return new Qi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function io(t,e){return no(t.databaseId,e.path)}function so(t){const e=function(t){const e=Qi.fromString(t);return Di(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?Qi.emptyPath():function(t){return Di(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function ro(t,e,n){return{name:io(t,e),fields:n.value.mapValue.fields}}function oo(t){let e=so(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){Di(1===i);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=ao(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new Ys(co(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,hs(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Ws(n,e)}(n.startAt));let h=null;return n.endAt&&(h=function(t){const e=!t.before,n=t.values||[];return new Ws(n,e)}(n.endAt)),function(t,e,n,i,s,r,o,a){return new tr(t,e,n,i,s,r,o,a)}(e,s,o,r,a,"F",c,h)}function ao(t){return t?void 0!==t.unaryFilter?[lo(t)]:void 0!==t.fieldFilter?[ho(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>ao(t))).reduce(((t,e)=>t.concat(e))):Ni():[]}function co(t){return Zi.fromServerFormat(t.fieldPath)}function ho(t){return Bs.create(co(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ni()}}(t.fieldFilter.op),t.fieldFilter.value)}function lo(t){switch(t.unaryFilter.op){case"IS_NAN":const e=co(t.unaryFilter.field);return Bs.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=co(t.unaryFilter.field);return Bs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=co(t.unaryFilter.field);return Bs.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=co(t.unaryFilter.field);return Bs.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Ni()}}function uo(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class fo{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ni(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new fo(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof fo?e:fo.resolve(e)}catch(t){return fo.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):fo.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):fo.reject(e)}static resolve(t){return new fo(((e,n)=>{e(t)}))}static reject(t){return new fo(((e,n)=>{n(t)}))}static waitFor(t){return new fo(((e,n)=>{let i=0,s=0,r=!1;t.forEach((t=>{++i,t.next((()=>{++s,r&&s===i&&e()}),(t=>n(t)))})),r=!0,s===i&&e()}))}static or(t){let e=fo.resolve(!1);for(const n of t)e=e.next((t=>t?fo.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}}function po(t){return"IndexedDbTransactionError"===t.name}class go{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Nr(i,t,n[e])}}applyToLocalView(t){for(const e of this.baseMutations)e.key.isEqual(t.key)&&Dr(e,t,this.localWriteTime);for(const e of this.mutations)e.key.isEqual(t.key)&&Dr(e,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach((e=>{const n=t.get(e.key),i=n;this.applyToLocalView(i),n.isValidDocument()||i.convertToNoDocument(Gi.min())}))}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Wr())}isEqual(t){return this.batchId===t.batchId&&Hi(this.mutations,t.mutations,((t,e)=>kr(t,e)))&&Hi(this.baseMutations,t.baseMutations,((t,e)=>kr(t,e)))}}class mo{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Di(t.mutations.length===n.length);let i=zr;const s=t.mutations;for(let t=0;t<s.length;t++)i=i.insert(s[t].key,n[t].version);return new mo(t,e,n,i)}}class yo{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class vo{constructor(t){this.Jt=t}}function wo(t){const e=oo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?function(t,e,n){return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(e,e.limit,"L"):e}class bo{constructor(){}Zt(t,e){this.te(t,e),e.ee()}te(t,e){if("nullValue"in t)this.ne(e,5);else if("booleanValue"in t)this.ne(e,10),e.se(t.booleanValue?1:0);else if("integerValue"in t)this.ne(e,15),e.se(ss(t.integerValue));else if("doubleValue"in t){const n=ss(t.doubleValue);isNaN(n)?this.ne(e,13):(this.ne(e,15),ls(n)?e.se(0):e.se(n))}else if("timestampValue"in t){const n=t.timestampValue;this.ne(e,20),"string"==typeof n?e.ie(n):(e.ie(`${n.seconds||""}`),e.se(n.nanos||0))}else if("stringValue"in t)this.re(t.stringValue,e),this.oe(e);else if("bytesValue"in t)this.ne(e,30),e.ue(rs(t.bytesValue)),this.oe(e);else if("referenceValue"in t)this.ae(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.ne(e,45),e.se(n.latitude||0),e.se(n.longitude||0)}else"mapValue"in t?As(t)?this.ne(e,Number.MAX_SAFE_INTEGER):(this.ce(t.mapValue,e),this.oe(e)):"arrayValue"in t?(this.he(t.arrayValue,e),this.oe(e)):Ni()}re(t,e){this.ne(e,25),this.le(t,e)}le(t,e){e.ie(t)}ce(t,e){const n=t.fields||{};this.ne(e,55);for(const t of Object.keys(n))this.re(t,e),this.te(n[t],e)}he(t,e){const n=t.values||[];this.ne(e,50);for(const t of n)this.te(t,e)}ae(t,e){this.ne(e,37),us.fromName(t).path.forEach((t=>{this.ne(e,60),this.le(t,e)}))}ne(t,e){t.se(e)}oe(t){t.se(2)}}bo.fe=new bo;class Eo{constructor(){this.qe=new To}addToCollectionParentIndex(t,e){return this.qe.add(e),fo.resolve()}getCollectionParents(t,e){return fo.resolve(this.qe.getEntries(e))}addFieldIndex(t,e){return fo.resolve()}deleteFieldIndex(t,e){return fo.resolve()}getDocumentsMatchingTarget(t,e){return fo.resolve(null)}getIndexType(t,e){return fo.resolve(0)}getFieldIndexes(t,e){return fo.resolve([])}getNextCollectionGroupToUpdate(t){return fo.resolve(null)}getMinOffset(t,e){return fo.resolve(_s.min())}updateCollectionGroup(t,e,n){return fo.resolve()}updateIndexEntries(t,e){return fo.resolve()}}class To{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new Ms(Qi.comparator),s=!i.has(n);return this.index[e]=i.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new Ms(Qi.comparator)).toArray()}}new Uint8Array(0);class Io{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Io(t,Io.DEFAULT_COLLECTION_PERCENTILE,Io.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Io.DEFAULT_COLLECTION_PERCENTILE=10,Io.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Io.DEFAULT=new Io(41943040,Io.DEFAULT_COLLECTION_PERCENTILE,Io.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Io.DISABLED=new Io(-1,0,0);class Ao{constructor(t){this.mn=t}next(){return this.mn+=2,this.mn}static gn(){return new Ao(0)}static yn(){return new Ao(-1)}}async function Co(t){if(t.code!==ki.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;Ii("LocalStore","Unexpectedly lost primary lease")}class So{constructor(t,e,n){this.ds=t,this.Bs=e,this.indexManager=n}Ls(t,e){return this.Bs.getAllMutationBatchesAffectingDocumentKey(t,e).next((n=>this.Us(t,e,n)))}Us(t,e,n){return this.ds.getEntry(t,e).next((t=>{for(const e of n)e.applyToLocalView(t);return t}))}qs(t,e){t.forEach(((t,n)=>{for(const t of e)t.applyToLocalView(n)}))}Ks(t,e){return this.ds.getEntries(t,e).next((e=>this.Gs(t,e).next((()=>e))))}Gs(t,e){return this.Bs.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>this.qs(e,t)))}Qs(t,e,n){return function(t){return us.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.js(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.Ws(t,e,n):this.zs(t,e,n)}js(t,e){return this.Ls(t,new us(e)).next((t=>{let e=Kr();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}Ws(t,e,n){const i=e.collectionGroup;let s=Kr();return this.indexManager.getCollectionParents(t,i).next((r=>fo.forEach(r,(r=>{const o=function(t,e){return new tr(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,r.child(i));return this.zs(t,o,n).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}zs(t,e,n){let i;return this.ds.getAllFromCollection(t,e.path,n).next((n=>(i=n,this.Bs.getAllMutationBatchesAffectingQuery(t,e)))).next((t=>{for(const e of t)for(const t of e.mutations){const n=t.key;let s=i.get(n);null==s&&(s=Ns.newInvalidDocument(n),i=i.insert(n,s)),Dr(t,s,e.localWriteTime),s.isFoundDocument()||(i=i.remove(n))}})).next((()=>(i.forEach(((t,n)=>{or(e,n)||(i=i.remove(t))})),i)))}}class No{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Hs=n,this.Js=i}static Ys(t,e){let n=Wr(),i=Wr();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new No(t,e.fromCache,n,i)}}class Do{constructor(){this.Xs=!1}initialize(t,e){this.Zs=t,this.indexManager=e,this.Xs=!0}Qs(t,e,n,i){return this.ti(t,e).next((s=>s||this.ei(t,e,i,n))).next((n=>n||this.ni(t,e)))}ti(t,e){return fo.resolve(null)}ei(t,e,n,i){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||i.isEqual(Gi.min())?this.ni(t,e):this.Zs.Ks(t,n).next((s=>{const r=this.si(e,s);return this.ii(e,r,n,i)?this.ni(t,e):(Ti()<=o.in.DEBUG&&Ii("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),rr(e)),this.ri(t,r,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,s=Gi.fromTimestamp(1e9===i?new Ki(n+1,0):new Ki(n,i));return new _s(s,us.empty(),e)}(i,-1)))}))}si(t,e){let n=new Ms(function(t){return(e,n)=>{let i=!1;for(const s of er(t)){const t=ar(s,e,n);if(0!==t)return t;i=i||s.field.isKeyField()}return 0}}(t));return e.forEach(((e,i)=>{or(t,i)&&(n=n.add(i))})),n}ii(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ni(t,e){return Ti()<=o.in.DEBUG&&Ii("QueryEngine","Using full collection scan to execute query:",rr(e)),this.Zs.Qs(t,e,_s.min())}ri(t,e,n,i){return this.Zs.Qs(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class _o{constructor(t,e,n,i){this.persistence=t,this.oi=e,this.M=i,this.ui=new Ls(qi),this.ai=new jr((t=>Vs(t)),Us),this.ci=new Map,this.hi=t.getRemoteDocumentCache(),this.fs=t.getTargetCache(),this._s=t.getBundleCache(),this.li(n)}li(t){this.indexManager=this.persistence.getIndexManager(t),this.Bs=this.persistence.getMutationQueue(t,this.indexManager),this.fi=new So(this.hi,this.Bs,this.indexManager),this.hi.setIndexManager(this.indexManager),this.oi.initialize(this.fi,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ui)))}}async function ko(t,e){const n=_i(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.Bs.getAllMutationBatches(t).next((s=>(i=s,n.li(e),n.Bs.getAllMutationBatches(t)))).next((e=>{const s=[],r=[];let o=Wr();for(const t of i){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.fi.Ks(t,o).next((t=>({di:t,removedBatchIds:s,addedBatchIds:r})))}))}))}function Lo(t,e){const n=_i(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.Bs.getNextMutationBatchAfterBatchId(t,e))))}class Ro{constructor(t){this.M=t,this.yi=new Map,this.pi=new Map}getBundleMetadata(t,e){return fo.resolve(this.yi.get(e))}saveBundleMetadata(t,e){var n;return this.yi.set(e.id,{id:(n=e).id,version:n.version,createTime:eo(n.createTime)}),fo.resolve()}getNamedQuery(t,e){return fo.resolve(this.pi.get(e))}saveNamedQuery(t,e){return this.pi.set(e.name,function(t){return{name:t.name,query:wo(t.bundledQuery),readTime:eo(t.readTime)}}(e)),fo.resolve()}}class Oo{constructor(){this.overlays=new Ls(us.comparator),this.Ii=new Map}getOverlay(t,e){return fo.resolve(this.overlays.get(e))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.Xt(t,e,i)})),fo.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.Ii.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.Ii.delete(n)),fo.resolve()}getOverlaysForCollection(t,e,n){const i=Gr(),s=e.length+1,r=new us(e.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const t=o.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===s&&t.largestBatchId>n&&i.set(t.getKey(),t)}return fo.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let s=new Ls(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=Gr(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Gr(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return fo.resolve(o)}Xt(t,e,n){if(null===n)return;const i=this.overlays.get(n.key);if(null!==i){const t=this.Ii.get(i.largestBatchId).delete(n.key);this.Ii.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new yo(e,n));let s=this.Ii.get(e);void 0===s&&(s=Wr(),this.Ii.set(e,s)),this.Ii.set(e,s.add(n.key))}}class Mo{constructor(){this.Ti=new Ms(Po.Ei),this.Ai=new Ms(Po.Ri)}isEmpty(){return this.Ti.isEmpty()}addReference(t,e){const n=new Po(t,e);this.Ti=this.Ti.add(n),this.Ai=this.Ai.add(n)}bi(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Pi(new Po(t,e))}Vi(t,e){t.forEach((t=>this.removeReference(t,e)))}vi(t){const e=new us(new Qi([])),n=new Po(e,t),i=new Po(e,t+1),s=[];return this.Ai.forEachInRange([n,i],(t=>{this.Pi(t),s.push(t.key)})),s}Si(){this.Ti.forEach((t=>this.Pi(t)))}Pi(t){this.Ti=this.Ti.delete(t),this.Ai=this.Ai.delete(t)}Di(t){const e=new us(new Qi([])),n=new Po(e,t),i=new Po(e,t+1);let s=Wr();return this.Ai.forEachInRange([n,i],(t=>{s=s.add(t.key)})),s}containsKey(t){const e=new Po(t,0),n=this.Ti.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Po{constructor(t,e){this.key=t,this.Ci=e}static Ei(t,e){return us.comparator(t.key,e.key)||qi(t.Ci,e.Ci)}static Ri(t,e){return qi(t.Ci,e.Ci)||us.comparator(t.key,e.key)}}class xo{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.Bs=[],this.xi=1,this.Ni=new Ms(Po.Ei)}checkEmpty(t){return fo.resolve(0===this.Bs.length)}addMutationBatch(t,e,n,i){const s=this.xi;this.xi++,this.Bs.length>0&&this.Bs[this.Bs.length-1];const r=new go(s,e,n,i);this.Bs.push(r);for(const e of i)this.Ni=this.Ni.add(new Po(e.key,s)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return fo.resolve(r)}lookupMutationBatch(t,e){return fo.resolve(this.ki(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.Mi(n),s=i<0?0:i;return fo.resolve(this.Bs.length>s?this.Bs[s]:null)}getHighestUnacknowledgedBatchId(){return fo.resolve(0===this.Bs.length?-1:this.xi-1)}getAllMutationBatches(t){return fo.resolve(this.Bs.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Po(e,0),i=new Po(e,Number.POSITIVE_INFINITY),s=[];return this.Ni.forEachInRange([n,i],(t=>{const e=this.ki(t.Ci);s.push(e)})),fo.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Ms(qi);return e.forEach((t=>{const e=new Po(t,0),i=new Po(t,Number.POSITIVE_INFINITY);this.Ni.forEachInRange([e,i],(t=>{n=n.add(t.Ci)}))})),fo.resolve(this.Oi(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let s=n;us.isDocumentKey(s)||(s=s.child(""));const r=new Po(new us(s),0);let o=new Ms(qi);return this.Ni.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.Ci)),!0)}),r),fo.resolve(this.Oi(o))}Oi(t){const e=[];return t.forEach((t=>{const n=this.ki(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Di(0===this.Fi(e.batchId,"removed")),this.Bs.shift();let n=this.Ni;return fo.forEach(e.mutations,(i=>{const s=new Po(i.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Ni=n}))}_n(t){}containsKey(t,e){const n=new Po(e,0),i=this.Ni.firstAfterOrEqual(n);return fo.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.Bs.length,fo.resolve()}Fi(t,e){return this.Mi(t)}Mi(t){return 0===this.Bs.length?0:t-this.Bs[0].batchId}ki(t){const e=this.Mi(t);return e<0||e>=this.Bs.length?null:this.Bs[e]}}class Fo{constructor(t){this.$i=t,this.docs=new Ls(us.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),s=i?i.size:0,r=this.$i(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return fo.resolve(n?n.document.mutableCopy():Ns.newInvalidDocument(e))}getEntries(t,e){let n=qr();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Ns.newInvalidDocument(t))})),fo.resolve(n)}getAllFromCollection(t,e,n){let i=qr();const s=new us(e.child("")),r=this.docs.getIteratorFrom(s);for(;r.hasNext();){const{key:t,value:{document:s}}=r.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||ks(Ds(s),n)<=0||(i=i.insert(s.key,s.mutableCopy()))}return fo.resolve(i)}getAllFromCollectionGroup(t,e,n,i){Ni()}Bi(t,e){return fo.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Vo(this)}getSize(t){return fo.resolve(this.size)}}class Vo extends class{constructor(){this.changes=new jr((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ns.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?fo.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Kn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Kn.addEntry(t,i)):this.Kn.removeEntry(n)})),fo.waitFor(e)}getFromCache(t,e){return this.Kn.getEntry(t,e)}getAllFromCache(t,e){return this.Kn.getEntries(t,e)}}class Uo{constructor(t){this.persistence=t,this.Li=new jr((t=>Vs(t)),Us),this.lastRemoteSnapshotVersion=Gi.min(),this.highestTargetId=0,this.Ui=0,this.qi=new Mo,this.targetCount=0,this.Ki=Ao.gn()}forEachTarget(t,e){return this.Li.forEach(((t,n)=>e(n))),fo.resolve()}getLastRemoteSnapshotVersion(t){return fo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return fo.resolve(this.Ui)}allocateTargetId(t){return this.highestTargetId=this.Ki.next(),fo.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ui&&(this.Ui=e),fo.resolve()}Tn(t){this.Li.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Ki=new Ao(e),this.highestTargetId=e),t.sequenceNumber>this.Ui&&(this.Ui=t.sequenceNumber)}addTargetData(t,e){return this.Tn(e),this.targetCount+=1,fo.resolve()}updateTargetData(t,e){return this.Tn(e),fo.resolve()}removeTargetData(t,e){return this.Li.delete(e.target),this.qi.vi(e.targetId),this.targetCount-=1,fo.resolve()}removeTargets(t,e,n){let i=0;const s=[];return this.Li.forEach(((r,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Li.delete(r),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),fo.waitFor(s).next((()=>i))}getTargetCount(t){return fo.resolve(this.targetCount)}getTargetData(t,e){const n=this.Li.get(e)||null;return fo.resolve(n)}addMatchingKeys(t,e,n){return this.qi.bi(e,n),fo.resolve()}removeMatchingKeys(t,e,n){this.qi.Vi(e,n);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((e=>{s.push(i.markPotentiallyOrphaned(t,e))})),fo.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.qi.vi(e),fo.resolve()}getMatchingKeysForTargetId(t,e){const n=this.qi.Di(e);return fo.resolve(n)}containsKey(t,e){return fo.resolve(this.qi.containsKey(e))}}class Bo{constructor(t,e){this.Gi={},this.overlays={},this.es=new Bi(0),this.ns=!1,this.ns=!0,this.referenceDelegate=t(this),this.fs=new Uo(this),this.indexManager=new Eo,this.ds=function(t){return new Fo(t)}((t=>this.referenceDelegate.Qi(t))),this.M=new vo(e),this._s=new Ro(this.M)}start(){return Promise.resolve()}shutdown(){return this.ns=!1,Promise.resolve()}get started(){return this.ns}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Oo,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Gi[t.toKey()];return n||(n=new xo(e,this.referenceDelegate),this.Gi[t.toKey()]=n),n}getTargetCache(){return this.fs}getRemoteDocumentCache(){return this.ds}getBundleCache(){return this._s}runTransaction(t,e,n){Ii("MemoryPersistence","Starting transaction:",t);const i=new jo(this.es.next());return this.referenceDelegate.ji(),n(i).next((t=>this.referenceDelegate.Wi(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}zi(t,e){return fo.or(Object.values(this.Gi).map((n=>()=>n.containsKey(t,e))))}}class jo extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}{constructor(t){super(),this.currentSequenceNumber=t}}class $o{constructor(t){this.persistence=t,this.Hi=new Mo,this.Ji=null}static Yi(t){return new $o(t)}get Xi(){if(this.Ji)return this.Ji;throw Ni()}addReference(t,e,n){return this.Hi.addReference(n,e),this.Xi.delete(n.toString()),fo.resolve()}removeReference(t,e,n){return this.Hi.removeReference(n,e),this.Xi.add(n.toString()),fo.resolve()}markPotentiallyOrphaned(t,e){return this.Xi.add(e.toString()),fo.resolve()}removeTarget(t,e){this.Hi.vi(e.targetId).forEach((t=>this.Xi.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Xi.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}ji(){this.Ji=new Set}Wi(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fo.forEach(this.Xi,(n=>{const i=us.fromPath(n);return this.Zi(t,i).next((t=>{t||e.removeEntry(i,Gi.min())}))})).next((()=>(this.Ji=null,e.apply(t))))}updateLimboDocument(t,e){return this.Zi(t,e).next((t=>{t?this.Xi.delete(e.toString()):this.Xi.add(e.toString())}))}Qi(t){return 0}Zi(t,e){return fo.or([()=>fo.resolve(this.Hi.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.zi(t,e)])}}class qo{constructor(){this.activeTargetIds=Yr}nr(t){this.activeTargetIds=this.activeTargetIds.add(t)}sr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}er(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ho{constructor(){this.Ur=new qo,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Ur.nr(t),this.qr[t]||"not-current"}updateQueryState(t,e,n){this.qr[t]=e}removeLocalQueryTarget(t){this.Ur.sr(t)}isLocalQueryTarget(t){return this.Ur.activeTargetIds.has(t)}clearQueryState(t){delete this.qr[t]}getAllActiveQueryTargets(){return this.Ur.activeTargetIds}isActiveQueryTarget(t){return this.Ur.activeTargetIds.has(t)}start(){return this.Ur=new qo,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Ko{Kr(t){}shutdown(){}}class Go{constructor(){this.Gr=()=>this.Qr(),this.jr=()=>this.Wr(),this.zr=[],this.Hr()}Kr(t){this.zr.push(t)}shutdown(){window.removeEventListener("online",this.Gr),window.removeEventListener("offline",this.jr)}Hr(){window.addEventListener("online",this.Gr),window.addEventListener("offline",this.jr)}Qr(){Ii("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.zr)t(0)}Wr(){Ii("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.zr)t(1)}static vt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const zo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Xo{constructor(t){this.Jr=t.Jr,this.Yr=t.Yr}Xr(t){this.Zr=t}eo(t){this.no=t}onMessage(t){this.so=t}close(){this.Yr()}send(t){this.Jr(t)}io(){this.Zr()}ro(t){this.no(t)}oo(t){this.so(t)}}class Wo extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.uo=e+"://"+t.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}co(t,e,n,i,s){const r=this.ho(t,e);Ii("RestConnection","Sending: ",r,n);const o={};return this.lo(o,i,s),this.fo(t,r,o,n).then((t=>(Ii("RestConnection","Received: ",t),t)),(e=>{throw Ci("RestConnection",`${t} failed with error: `,e,"url: ",r,"request:",n),e}))}_o(t,e,n,i,s){return this.co(t,e,n,i,s)}lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+bi,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}ho(t,e){const n=zo[t];return`${this.uo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,n,i){return new Promise(((s,r)=>{const o=new yi;o.listenOnce(fi.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case ui.NO_ERROR:const e=o.getResponseJson();Ii("Connection","XHR received:",JSON.stringify(e)),s(e);break;case ui.TIMEOUT:Ii("Connection",'RPC "'+t+'" timed out'),r(new Li(ki.DEADLINE_EXCEEDED,"Request time out"));break;case ui.HTTP_ERROR:const n=o.getStatus();if(Ii("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(ki).indexOf(e)>=0?e:ki.UNKNOWN}(t.status);r(new Li(e,t.message))}else r(new Li(ki.UNKNOWN,"Server responded with status "+o.getStatus()))}else r(new Li(ki.UNAVAILABLE,"Connection failed."));break;default:Ni()}}finally{Ii("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))}wo(t,e,n){const i=[this.uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=hi(),r=li(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new gi({})),this.lo(o.initMessageHeaders,e,n),(0,a.uI)()||(0,a.b$)()||(0,a.d)()||(0,a.w1)()||(0,a.Mn)()||(0,a.ru)()||(o.httpHeadersOverwriteParam="$httpHeaders");const c=i.join("");Ii("Connection","Creating WebChannel: "+c,o);const h=s.createWebChannel(c,o);let l=!1,u=!1;const f=new Xo({Jr:t=>{u?Ii("Connection","Not sending because WebChannel is closed:",t):(l||(Ii("Connection","Opening WebChannel transport."),h.open(),l=!0),Ii("Connection","WebChannel sending:",t),h.send(t))},Yr:()=>h.close()}),d=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return d(h,mi.EventType.OPEN,(()=>{u||Ii("Connection","WebChannel transport opened.")})),d(h,mi.EventType.CLOSE,(()=>{u||(u=!0,Ii("Connection","WebChannel transport closed"),f.ro())})),d(h,mi.EventType.ERROR,(t=>{u||(u=!0,Ci("Connection","WebChannel transport errored:",t),f.ro(new Li(ki.UNAVAILABLE,"The operation could not be completed")))})),d(h,mi.EventType.MESSAGE,(t=>{var e;if(!u){const n=t.data[0];Di(!!n);const i=n,s=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(s){Ii("Connection","WebChannel received error:",s);const t=s.status;let e=function(t){const e=Ur[t];if(void 0!==e)return function(t){if(void 0===t)return Ai("GRPC error has no .code"),ki.UNKNOWN;switch(t){case Ur.OK:return ki.OK;case Ur.CANCELLED:return ki.CANCELLED;case Ur.UNKNOWN:return ki.UNKNOWN;case Ur.DEADLINE_EXCEEDED:return ki.DEADLINE_EXCEEDED;case Ur.RESOURCE_EXHAUSTED:return ki.RESOURCE_EXHAUSTED;case Ur.INTERNAL:return ki.INTERNAL;case Ur.UNAVAILABLE:return ki.UNAVAILABLE;case Ur.UNAUTHENTICATED:return ki.UNAUTHENTICATED;case Ur.INVALID_ARGUMENT:return ki.INVALID_ARGUMENT;case Ur.NOT_FOUND:return ki.NOT_FOUND;case Ur.ALREADY_EXISTS:return ki.ALREADY_EXISTS;case Ur.PERMISSION_DENIED:return ki.PERMISSION_DENIED;case Ur.FAILED_PRECONDITION:return ki.FAILED_PRECONDITION;case Ur.ABORTED:return ki.ABORTED;case Ur.OUT_OF_RANGE:return ki.OUT_OF_RANGE;case Ur.UNIMPLEMENTED:return ki.UNIMPLEMENTED;case Ur.DATA_LOSS:return ki.DATA_LOSS;default:return Ni()}}(e)}(t),n=s.message;void 0===e&&(e=ki.INTERNAL,n="Unknown error status: "+t+" with message "+s.message),u=!0,f.ro(new Li(e,n)),h.close()}else Ii("Connection","WebChannel received:",n),f.oo(n)}})),d(r,di.STAT_EVENT,(t=>{t.stat===pi.PROXY?Ii("Connection","Detected buffering proxy"):t.stat===pi.NOPROXY&&Ii("Connection","Detected no buffering proxy")})),setTimeout((()=>{f.io()}),0),f}}function Yo(){return"undefined"!=typeof document?document:null}function Qo(t){return new Qr(t,!0)}class Jo{constructor(t,e,n=1e3,i=1.5,s=6e4){this.Yn=t,this.timerId=e,this.mo=n,this.yo=i,this.po=s,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),i=Math.max(0,e-n);i>0&&Ii("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.To=this.Yn.enqueueAfterDelay(this.timerId,i,(()=>(this.Eo=Date.now(),t()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Zo extends class{constructor(t,e,n,i,s,r,o,a){this.Yn=t,this.Vo=n,this.vo=i,this.So=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Do=0,this.Co=null,this.xo=null,this.stream=null,this.No=new Jo(t,e)}ko(){return 1===this.state||5===this.state||this.Mo()}Mo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.ko()&&await this.close(0)}Fo(){this.state=0,this.No.reset()}$o(){this.Mo()&&null===this.Co&&(this.Co=this.Yn.enqueueAfterDelay(this.Vo,6e4,(()=>this.Bo())))}Lo(t){this.Uo(),this.stream.send(t)}async Bo(){if(this.Mo())return this.close(0)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}qo(){this.xo&&(this.xo.cancel(),this.xo=null)}async close(t,e){this.Uo(),this.qo(),this.No.cancel(),this.Do++,4!==t?this.No.reset():e&&e.code===ki.RESOURCE_EXHAUSTED?(Ai(e.toString()),Ai("Using maximum backoff delay to prevent overloading the backend."),this.No.Ao()):e&&e.code===ki.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Ko(),this.stream.close(),this.stream=null),this.state=t,await this.listener.eo(e)}Ko(){}auth(){this.state=1;const t=this.Go(this.Do),e=this.Do;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Do===e&&this.Qo(t,n)}),(e=>{t((()=>{const t=new Li(ki.UNKNOWN,"Fetching auth token failed: "+e.message);return this.jo(t)}))}))}Qo(t,e){const n=this.Go(this.Do);this.stream=this.Wo(t,e),this.stream.Xr((()=>{n((()=>(this.state=2,this.xo=this.Yn.enqueueAfterDelay(this.vo,1e4,(()=>(this.Mo()&&(this.state=3),Promise.resolve()))),this.listener.Xr())))})),this.stream.eo((t=>{n((()=>this.jo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Oo(){this.state=5,this.No.Ro((async()=>{this.state=0,this.start()}))}jo(t){return Ii("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Go(t){return e=>{this.Yn.enqueueAndForget((()=>this.Do===t?e():(Ii("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}{constructor(t,e,n,i,s,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,r),this.M=s,this.Yo=!1}get Xo(){return this.Yo}start(){this.Yo=!1,this.lastStreamToken=void 0,super.start()}Ko(){this.Yo&&this.Zo([])}Wo(t,e){return this.So.wo("Write",t,e)}onMessage(t){if(Di(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Yo){this.No.reset();const e=function(t,e){return t&&t.length>0?(Di(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?eo(t.updateTime):eo(e);return n.isEqual(Gi.min())&&(n=eo(e)),new Ir(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=eo(t.commitTime);return this.listener.tu(n,e)}return Di(!t.writeResults||0===t.writeResults.length),this.Yo=!0,this.listener.eu()}nu(){const t={};t.database=function(t){return new Qi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.M),this.Lo(t)}Zo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Rr)n={update:ro(t,e.key,e.value)};else if(e instanceof Fr)n={delete:io(t,e.key)};else if(e instanceof Or)n={update:ro(t,e.key,e.data),updateMask:uo(e.fieldMask)};else{if(!(e instanceof Vr))return Ni();n={verify:io(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof gr)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof mr)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof vr)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof br)return{fieldPath:e.field.canonicalString(),increment:n.k};throw Ni()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:to(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ni()}(t,e.precondition)),n}(this.M,t)))};this.Lo(e)}}class ta extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.So=n,this.M=i,this.su=!1}iu(){if(this.su)throw new Li(ki.FAILED_PRECONDITION,"The client has already been terminated.")}co(t,e,n){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.So.co(t,e,n,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ki.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Li(ki.UNKNOWN,t.toString())}))}_o(t,e,n){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.So._o(t,e,n,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ki.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Li(ki.UNKNOWN,t.toString())}))}terminate(){this.su=!0}}class ea{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.ru=0,this.ou=null,this.uu=!0}au(){0===this.ru&&(this.cu("Unknown"),this.ou=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ou=null,this.hu("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}lu(t){"Online"===this.state?this.cu("Unknown"):(this.ru++,this.ru>=1&&(this.fu(),this.hu(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.fu(),this.ru=0,"Online"===t&&(this.uu=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}hu(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.uu?(Ai(e),this.uu=!1):Ii("OnlineStateTracker",e)}fu(){null!==this.ou&&(this.ou.cancel(),this.ou=null)}}class na{constructor(t,e,n,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.du=[],this._u=new Map,this.wu=new Set,this.mu=[],this.gu=s,this.gu.Kr((t=>{n.enqueueAndForget((async()=>{ra(this)&&(Ii("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=_i(t);e.wu.add(4),await sa(e),e.yu.set("Unknown"),e.wu.delete(4),await ia(e)}(this))}))})),this.yu=new ea(n,i)}}async function ia(t){if(ra(t))for(const e of t.mu)await e(!0)}async function sa(t){for(const e of t.mu)await e(!1)}function ra(t){return 0===_i(t).wu.size}async function oa(t,e,n){if(!po(e))throw e;t.wu.add(1),await sa(t),t.yu.set("Offline"),n||(n=()=>function(t){const e=_i(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.fs.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ii("RemoteStore","Retrying IndexedDB access"),await n(),t.wu.delete(1),await ia(t)}))}function aa(t,e){return e().catch((n=>oa(t,n,e)))}async function ca(t){const e=_i(t),n=va(e);let i=e.du.length>0?e.du[e.du.length-1].batchId:-1;for(;ha(e);)try{const t=await Lo(e.localStore,i);if(null===t){0===e.du.length&&n.$o();break}i=t.batchId,la(e,t)}catch(t){await oa(e,t)}ua(e)&&fa(e)}function ha(t){return ra(t)&&t.du.length<10}function la(t,e){t.du.push(e);const n=va(t);n.Mo()&&n.Xo&&n.Zo(e.mutations)}function ua(t){return ra(t)&&!va(t).ko()&&t.du.length>0}function fa(t){va(t).start()}async function da(t){va(t).nu()}async function pa(t){const e=va(t);for(const n of t.du)e.Zo(n.mutations)}async function ga(t,e,n){const i=t.du.shift(),s=mo.from(i,e,n);await aa(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await ca(t)}async function ma(t,e){e&&va(t).Xo&&await async function(t,e){if(function(t){switch(t){default:return Ni();case ki.CANCELLED:case ki.UNKNOWN:case ki.DEADLINE_EXCEEDED:case ki.RESOURCE_EXHAUSTED:case ki.INTERNAL:case ki.UNAVAILABLE:case ki.UNAUTHENTICATED:return!1;case ki.INVALID_ARGUMENT:case ki.NOT_FOUND:case ki.ALREADY_EXISTS:case ki.PERMISSION_DENIED:case ki.FAILED_PRECONDITION:case ki.ABORTED:case ki.OUT_OF_RANGE:case ki.UNIMPLEMENTED:case ki.DATA_LOSS:return!0}}(n=e.code)&&n!==ki.ABORTED){const n=t.du.shift();va(t).Fo(),await aa(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await ca(t)}var n}(t,e),ua(t)&&fa(t)}async function ya(t,e){const n=_i(t);n.asyncQueue.verifyOperationInProgress(),Ii("RemoteStore","RemoteStore received new credentials");const i=ra(n);n.wu.add(3),await sa(n),i&&n.yu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.wu.delete(3),await ia(n)}function va(t){return t.Tu||(t.Tu=function(t,e,n){const i=_i(t);return i.iu(),new Zo(e,i.So,i.authCredentials,i.appCheckCredentials,i.M,n)}(t.datastore,t.asyncQueue,{Xr:da.bind(null,t),eo:ma.bind(null,t),eu:pa.bind(null,t),tu:ga.bind(null,t)}),t.mu.push((async e=>{e?(t.Tu.Fo(),await ca(t)):(await t.Tu.stop(),t.du.length>0&&(Ii("RemoteStore",`Stopping write stream with ${t.du.length} pending writes`),t.du=[]))}))),t.Tu}class wa{constructor(t,e,n,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,s){const r=Date.now()+n,o=new wa(t,e,r,i,s);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Li(ki.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ba(t,e){if(Ai("AsyncQueue",`${e}: ${t}`),po(t))return new Li(ki.UNAVAILABLE,`${e}: ${t}`);throw t}class Ea{constructor(){this.queries=new jr((t=>sr(t)),ir),this.onlineState="Unknown",this.bu=new Set}}class Ta{constructor(t,e,n,i,s,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.sa={},this.ia=new jr((t=>sr(t)),ir),this.ra=new Map,this.oa=new Set,this.ua=new Ls(us.comparator),this.aa=new Map,this.ca=new Mo,this.ha={},this.la=new Map,this.fa=Ao.yn(),this.onlineState="Unknown",this.da=void 0}get isPrimaryClient(){return!0===this.da}}function Ia(t,e,n){const i=_i(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ia.forEach(((n,i)=>{const s=i.view.Pu(e);s.snapshot&&t.push(s.snapshot)})),function(t,e){const n=_i(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.Pu(e)&&(i=!0)})),i&&function(t){t.bu.forEach((t=>{t.next()}))}(n)}(i.eventManager,e),t.length&&i.sa.zo(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Aa(t,e){const n=_i(t),i=e.batch.batchId;try{const t=await function(t,e){const n=_i(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),s=n.hi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const s=n.batch,r=s.keys();let o=fo.resolve();return r.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);Di(null!==r),e.version.compareTo(r)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.Bs.removeMutationBatch(e,s)))}(n,t,e,s).next((()=>s.apply(t))).next((()=>n.Bs.performConsistencyCheck(t))).next((()=>n.fi.Ks(t,i)))}))}(n.localStore,e);Na(n,i,null),Sa(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Da(n,t)}catch(t){await Co(t)}}async function Ca(t,e,n){const i=_i(t);try{const t=await function(t,e){const n=_i(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.Bs.lookupMutationBatch(t,e).next((e=>(Di(null!==e),i=e.keys(),n.Bs.removeMutationBatch(t,e)))).next((()=>n.Bs.performConsistencyCheck(t))).next((()=>n.fi.Ks(t,i)))}))}(i.localStore,e);Na(i,e,n),Sa(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Da(i,t)}catch(n){await Co(n)}}function Sa(t,e){(t.la.get(e)||[]).forEach((t=>{t.resolve()})),t.la.delete(e)}function Na(t,e,n){const i=_i(t);let s=i.ha[i.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),i.ha[i.currentUser.toKey()]=s}}async function Da(t,e,n){const i=_i(t),s=[],r=[],o=[];i.ia.isEmpty()||(i.ia.forEach(((t,a)=>{o.push(i._a(a,e,n).then((t=>{if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),s.push(t);const e=No.Ys(a.targetId,t);r.push(e)}})))})),await Promise.all(o),i.sa.zo(s),await async function(t,e){const n=_i(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>fo.forEach(e,(e=>fo.forEach(e.Hs,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>fo.forEach(e.Js,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!po(t))throw t;Ii("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ui.get(e),i=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(i);n.ui=n.ui.insert(e,s)}}}(i.localStore,r))}async function _a(t,e){const n=_i(t);if(!n.currentUser.isEqual(e)){Ii("SyncEngine","User change. New user:",e.toKey());const t=await ko(n.localStore,e);n.currentUser=e,function(t,e){t.la.forEach((t=>{t.forEach((t=>{t.reject(new Li(ki.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.la.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Da(n,t.di)}}function ka(t){const e=_i(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Aa.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ca.bind(null,e),e}class La{constructor(){this.synchronizeTabs=!1}async initialize(t){this.M=Qo(t.databaseInfo.databaseId),this.sharedClientState=this.ga(t),this.persistence=this.ya(t),await this.persistence.start(),this.gcScheduler=this.pa(t),this.localStore=this.Ia(t)}pa(t){return null}Ia(t){return function(t,e,n,i){return new _o(t,e,n,i)}(this.persistence,new Do,t.initialUser,this.M)}ya(t){return new Bo($o.Yi,this.M)}ga(t){return new Ho}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Ra{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Ia(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=_a.bind(null,this.syncEngine),await async function(t,e){const n=_i(t);e?(n.wu.delete(2),await ia(n)):e||(n.wu.add(2),await sa(n),n.yu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Ea}createDatastore(t){const e=Qo(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Wo(i));var i;return function(t,e,n,i){return new ta(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,s=t=>Ia(this.syncEngine,t,0),r=Go.vt()?new Go:new Ko,new na(e,n,i,s,r);var e,n,i,s,r}createSyncEngine(t,e){return function(t,e,n,i,s,r,o){const a=new Ta(t,e,n,i,s,r);return o&&(a.da=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=_i(t);Ii("RemoteStore","RemoteStore shutting down."),e.wu.add(5),await sa(e),e.gu.shutdown(),e.yu.set("Unknown")}(this.remoteStore)}}class Oa{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=wi.UNAUTHENTICATED,this.clientId=$i.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Ii("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Ii("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Li(ki.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=ba(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Ma(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(Ii("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),Ii("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await ko(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new La)),t.offlineComponents}(t);Ii("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>ya(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>ya(e.remoteStore,n))),t.onlineComponents=e}function Pa(t){return async function(t){return t.onlineComponents||(Ii("FirestoreClient","Using default OnlineComponentProvider"),await Ma(t,new Ra)),t.onlineComponents}(t).then((t=>t.syncEngine))}const xa=new Map;function Fa(t,e,n){if(!n)throw new Li(ki.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Va(t){if(!us.isDocumentKey(t))throw new Li(ki.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ua(t){if(us.isDocumentKey(t))throw new Li(ki.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ba(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Ni()}class ja{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Li(ki.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Li(ki.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new Li(ki.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class $a{constructor(t,e,n){this._authCredentials=e,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ja({}),this._settingsFrozen=!1,t instanceof cs?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Li(ki.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cs(t.options.projectId)}(t))}get app(){if(!this._app)throw new Li(ki.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Li(ki.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ja(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Mi;switch(t.type){case"gapi":const e=t.client;return Di(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Fi(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Li(ki.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=xa.get(t);e&&(Ii("ComponentProvider","Removing Datastore"),xa.delete(t),e.terminate())}(this),Promise.resolve()}}class qa{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ka(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new qa(this.firestore,t,this._key)}}class Ha{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Ha(this.firestore,t,this._query)}}class Ka extends Ha{constructor(t,e,n){super(t,e,function(t){return new tr(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new qa(this.firestore,null,new us(t))}withConverter(t){return new Ka(this.firestore,t,this._path)}}function Ga(t,e,...n){if(t=(0,a.m9)(t),Fa("collection","path",e),t instanceof $a){const i=Qi.fromString(e,...n);return Ua(i),new Ka(t,null,i)}{if(!(t instanceof qa||t instanceof Ka))throw new Li(ki.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Qi.fromString(e,...n));return Ua(i),new Ka(t.firestore,null,i)}}class za{constructor(){this.Fa=Promise.resolve(),this.$a=[],this.Ba=!1,this.La=[],this.Ua=null,this.qa=!1,this.Ka=!1,this.Ga=[],this.No=new Jo(this,"async_queue_retry"),this.Qa=()=>{const t=Yo();t&&Ii("AsyncQueue","Visibility state changed to "+t.visibilityState),this.No.Po()};const t=Yo();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Qa)}get isShuttingDown(){return this.Ba}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ja(),this.Wa(t)}enterRestrictedMode(t){if(!this.Ba){this.Ba=!0,this.Ka=t||!1;const e=Yo();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Qa)}}enqueue(t){if(this.ja(),this.Ba)return new Promise((()=>{}));const e=new Ri;return this.Wa((()=>this.Ba&&this.Ka?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.$a.push(t),this.za())))}async za(){if(0!==this.$a.length){try{await this.$a[0](),this.$a.shift(),this.No.reset()}catch(t){if(!po(t))throw t;Ii("AsyncQueue","Operation failed with retryable error: "+t)}this.$a.length>0&&this.No.Ro((()=>this.za()))}}Wa(t){const e=this.Fa.then((()=>(this.qa=!0,t().catch((t=>{this.Ua=t,this.qa=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Ai("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.qa=!1,t))))));return this.Fa=e,e}enqueueAfterDelay(t,e,n){this.ja(),this.Ga.indexOf(t)>-1&&(e=0);const i=wa.createAndSchedule(this,t,e,n,(t=>this.Ha(t)));return this.La.push(i),i}ja(){this.Ua&&Ni()}verifyOperationInProgress(){}async Ja(){let t;do{t=this.Fa,await t}while(t!==this.Fa)}Ya(t){for(const e of this.La)if(e.timerId===t)return!0;return!1}Xa(t){return this.Ja().then((()=>{this.La.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.La)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Ja()}))}Za(t){this.Ga.push(t)}Ha(t){const e=this.La.indexOf(t);this.La.splice(e,1)}}class Xa extends $a{constructor(t,e,n){super(t,e,n),this.type="firestore",this._queue=new za,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Ya(this),this._firestoreClient.terminate()}}function Wa(t=(0,s.Mq)()){return(0,s.qX)(t,"firestore").getImmediate()}function Ya(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new as(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Oa(t._authCredentials,t._appCheckCredentials,t._queue,i)}class Qa{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Li(ki.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zi(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ja{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ja(es.fromBase64String(t))}catch(t){throw new Li(ki.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Ja(es.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Za{constructor(t){this._methodName=t}}class tc{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Li(ki.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Li(ki.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return qi(this._lat,t._lat)||qi(this._long,t._long)}}const ec=/^__.*__$/;class nc{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new Or(t,this.data,this.fieldMask,e,this.fieldTransforms):new Rr(t,this.data,e,this.fieldTransforms)}}function ic(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ni()}}class sc{constructor(t,e,n,i,s,r){this.settings=t,this.databaseId=e,this.M=n,this.ignoreUndefinedProperties=i,void 0===s&&this.tc(),this.fieldTransforms=s||[],this.fieldMask=r||[]}get path(){return this.settings.path}get ec(){return this.settings.ec}nc(t){return new sc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.M,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}sc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.nc({path:n,ic:!1});return i.rc(t),i}oc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.nc({path:n,ic:!1});return i.tc(),i}uc(t){return this.nc({path:void 0,ic:!0})}ac(t){return pc(t,this.settings.methodName,this.settings.cc||!1,this.path,this.settings.hc)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}tc(){if(this.path)for(let t=0;t<this.path.length;t++)this.rc(this.path.get(t))}rc(t){if(0===t.length)throw this.ac("Document fields must not be empty");if(ic(this.ec)&&ec.test(t))throw this.ac('Document fields cannot begin and end with "__"')}}class rc{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.M=n||Qo(t)}lc(t,e,n,i=!1){return new sc({ec:t,methodName:e,hc:n,path:Zi.emptyPath(),ic:!1,cc:i},this.databaseId,this.M,this.ignoreUndefinedProperties)}}function oc(t){const e=t._freezeSettings(),n=Qo(t._databaseId);return new rc(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ac(t,e,n,i,s,r={}){const o=t.lc(r.merge||r.mergeFields?2:0,e,n,s);uc("Data must be an object, but it was:",o,i);const a=hc(i,o);let c,h;if(r.merge)c=new ts(o.fieldMask),h=o.fieldTransforms;else if(r.mergeFields){const t=[];for(const i of r.mergeFields){const s=fc(e,i,n);if(!o.contains(s))throw new Li(ki.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);gc(t,s)||t.push(s)}c=new ts(t),h=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,h=o.fieldTransforms;return new nc(new Cs(a),c,h)}function cc(t,e){if(lc(t=(0,a.m9)(t)))return uc("Unsupported field value:",e,t),hc(t,e);if(t instanceof Za)return function(t,e){if(!ic(e.ec))throw e.ac(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.ac(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.ic&&4!==e.ec)throw e.ac("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const s of t){let t=cc(s,e.uc(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,a.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return lr(e.M,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Ki.fromDate(t);return{timestampValue:Jr(e.M,n)}}if(t instanceof Ki){const n=new Ki(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Jr(e.M,n)}}if(t instanceof tc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ja)return{bytesValue:Zr(e.M,t._byteString)};if(t instanceof qa){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.ac(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:no(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ac(`Unsupported field value: ${Ba(t)}`)}(t,e)}function hc(t,e){const n={};return Wi(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xi(t,((t,i)=>{const s=cc(i,e.sc(t));null!=s&&(n[t]=s)})),{mapValue:{fields:n}}}function lc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ki||t instanceof tc||t instanceof Ja||t instanceof qa||t instanceof Za)}function uc(t,e,n){if(!lc(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Ba(n);throw"an object"===i?e.ac(t+" a custom object"):e.ac(t+" "+i)}}function fc(t,e,n){if((e=(0,a.m9)(e))instanceof Qa)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(dc)>=0)throw pc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qa(...e.split("."))._internalPath}catch(i){throw pc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw pc("Field path arguments must be of type string or ",t,!1,void 0,n)}const dc=new RegExp("[~\\*/\\[\\]]");function pc(t,e,n,i,s){const r=i&&!i.isEmpty(),o=void 0!==s;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new Li(ki.INVALID_ARGUMENT,a+t+c)}function gc(t,e){return t.some((t=>t.isEqual(e)))}function mc(t,e){const n=function(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Li(ki.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ba(t);throw new Li(ki.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}(t.firestore,Xa),i=function(t,e,...n){if(t=(0,a.m9)(t),1===arguments.length&&(e=$i.R()),Fa("doc","path",e),t instanceof $a){const i=Qi.fromString(e,...n);return Va(i),new qa(t,null,new us(i))}{if(!(t instanceof qa||t instanceof Ka))throw new Li(ki.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Qi.fromString(e,...n));return Va(i),new qa(t.firestore,t instanceof Ka?t.converter:null,new us(i))}}(t),s=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return function(t,e){return function(t,e){const n=new Ri;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=ka(t);try{const t=await function(t,e){const n=_i(t),i=Ki.now(),s=e.reduce(((t,e)=>t.add(e.key)),Wr());let r;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>n.fi.Ks(t,s).next((s=>{r=s;const o=[];for(const t of e){const e=_r(t,r.get(t.key));null!=e&&o.push(new Or(t.key,e,Ss(e.value.mapValue),Ar.exists(!0)))}return n.Bs.addMutationBatch(t,i,o,e)})))).then((t=>(t.applyToLocalDocumentSet(r),{batchId:t.batchId,changes:r})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.ha[t.currentUser.toKey()];i||(i=new Ls(qi)),i=i.insert(e,n),t.ha[t.currentUser.toKey()]=i}(i,t.batchId,n),await Da(i,t.changes),await ca(i.remoteStore)}catch(t){const e=ba(t,"Failed to persist write");n.reject(e)}}(await Pa(t),e,n))),n.promise}(function(t){return t._firestoreClient||Ya(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[ac(oc(t.firestore),"addDoc",i._key,s,null!==t.converter,{}).toMutation(i._key,Ar.exists(!1))]).then((()=>i))}!function(t,e=!0){!function(t){bi=t}(s.Jn),(0,s.Xd)(new r.wA("firestore",((t,{options:n})=>{const i=t.getProvider("app").getImmediate(),s=new Xa(i,new Pi(t.getProvider("auth-internal")),new Ui(t.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:e},n),s._setSettings(n),s}),"PUBLIC")),(0,s.KN)(vi,"3.4.9",t),(0,s.KN)(vi,"3.4.9","esm2017")}()},238:function(t,e,n){n.d(e,{Jn:function(){return w},KN:function(){return T},Mq:function(){return E},Xd:function(){return g},ZF:function(){return b},qX:function(){return m}});var i=n(463),s=n(333),r=n(444),o=n(424);class a{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const c="@firebase/app",h="0.7.24",l=new s.Yd("@firebase/app"),u={[c]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},f=new Map,d=new Map;function p(t,e){try{t.container.addComponent(e)}catch(n){l.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function g(t){const e=t.name;if(d.has(e))return l.debug(`There were multiple attempts to register component ${e}.`),!1;d.set(e,t);for(const e of f.values())p(e,t);return!0}function m(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const y=new r.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class v{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw y.create("app-deleted",{appName:this._name})}}const w="9.8.1";function b(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},e),s=n.name;if("string"!=typeof s||!s)throw y.create("bad-app-name",{appName:String(s)});const o=f.get(s);if(o){if((0,r.vZ)(t,o.options)&&(0,r.vZ)(n,o.config))return o;throw y.create("duplicate-app",{appName:s})}const a=new i.H0(s);for(const t of d.values())a.addComponent(t);const c=new v(t,n,a);return f.set(s,c),c}function E(t="[DEFAULT]"){const e=f.get(t);if(!e)throw y.create("no-app",{appName:t});return e}function T(t,e,n){var s;let r=null!==(s=u[t])&&void 0!==s?s:t;n&&(r+=`-${n}`);const o=r.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${r}" with version "${e}":`];return o&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void l.warn(t.join(" "))}g(new i.wA(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const I="firebase-heartbeat-store";let A=null;function C(){return A||(A=(0,o.X3)("firebase-heartbeat-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(I)}}).catch((t=>{throw y.create("storage-open",{originalErrorMessage:t.message})}))),A}async function S(t,e){try{const n=(await C()).transaction(I,"readwrite"),i=n.objectStore(I);return await i.put(e,N(t)),n.done}catch(t){throw y.create("storage-set",{originalErrorMessage:t.message})}}function N(t){return`${t.name}!${t.options.appId}`}class D{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new k(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=_();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=_(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),L(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),L(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=(0,r.L)(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function _(){return(new Date).toISOString().substring(0,10)}class k{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,r.hl)()&&(0,r.eu)().then((()=>!0)).catch((()=>!1))}async read(){return await this._canUseIndexedDBPromise&&await async function(t){try{return(await C()).transaction(I).objectStore(I).get(N(t))}catch(t){throw y.create("storage-get",{originalErrorMessage:t.message})}}(this.app)||{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return S(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return S(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function L(t){return(0,r.L)(JSON.stringify({version:2,heartbeats:t})).length}g(new i.wA("platform-logger",(t=>new a(t)),"PRIVATE")),g(new i.wA("heartbeat",(t=>new D(t)),"PRIVATE")),T(c,h,""),T(c,h,"esm2017"),T("fire-js","")},463:function(t,e,n){n.d(e,{H0:function(){return a},wA:function(){return s}});var i=n(444);class s{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const r="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:r})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===r?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:r:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},333:function(t,e,n){n.d(e,{Yd:function(){return h},in:function(){return s}});const i=[];var s;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(s||(s={}));const r={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},o=s.INFO,a={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},c=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=a[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class h{constructor(t){this.name=t,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in s))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?r[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...t),this._logHandler(this,s.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...t),this._logHandler(this,s.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,s.INFO,...t),this._logHandler(this,s.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,s.WARN,...t),this._logHandler(this,s.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,s.ERROR,...t),this._logHandler(this,s.ERROR,...t)}}},424:function(t,e,n){let i,s;n.d(e,{X3:function(){return p}});const r=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,h=new WeakMap;let l={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return o.get(t);if("objectStoreNames"===e)return t.objectStoreNames||a.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function u(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(d(this),t),f(r.get(this))}:function(...t){return f(e.apply(d(this),t))}:function(t,...n){const i=e.call(d(this),t,...n);return a.set(i,t.sort?t.sort():[t]),f(i)}:(t instanceof IDBTransaction&&function(t){if(o.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));o.set(t,e)}(t),n=t,(i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>n instanceof t))?new Proxy(t,l):t);var e,n}function f(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(f(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&r.set(e,t)})).catch((()=>{})),h.set(e,t),e}(t);if(c.has(t))return c.get(t);const e=u(t);return e!==t&&(c.set(t,e),h.set(e,t)),e}const d=t=>h.get(t);function p(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=f(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(f(o.result),t.oldVersion,t.newVersion,f(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),a}const g=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],y=new Map;function v(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(y.get(e))return y.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=m.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!g.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return y.set(e,r),r}var w;w=l,l={...w,get:(t,e,n)=>v(t,e)||w.get(t,e,n),has:(t,e)=>!!v(t,e)||w.has(t,e)}}}]);